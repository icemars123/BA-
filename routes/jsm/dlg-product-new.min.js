var selectedProductIdImageId=null;function doDlgProductNew(Q,j){var H=_.isUndefined(j)||_.isNull(j),o={},d=null,r=null;function c(){H?($("#fldNewProductCode").textbox("clear"),$("#fldNewProductName").textbox("clear"),$("#fldNewProductBarcode").textbox("clear"),$("#fldNewProductAltcode").textbox("clear"),$("#fldNewProductCostPrice").numberbox("clear"),$("#fldNewProductUOM").textbox("clear"),$("#fldNewProductUOMSize").numberbox("clear"),$("#cbNewProductClients").combotree("clear"),$("#cbNewProductActive").switchbutton("check"),$("#cbNewProductBuyTaxCode").combobox("clear"),$("#cbNewProductSellTaxCode").combobox("clear"),$("#cbNewProductSalesAccount").combotree("clear"),$("#cbNewProductIncomeAccount").combotree("clear"),$("#cbNewProductAssetAccount").combotree("clear"),$("#cbNewProductBuildTemplate").combotree("clear"),$("#fldNewProductMinQty").numberbox("clear"),$("#fldNewProductWarnQty").numberbox("clear"),$("#cbNewProductAlias").combobox("clear"),$("#cbNewProductLocation1").combotree("clear"),$("#cbNewProductLocation2").combotree("clear"),$("#fldNewProductWidth").numberbox("clear"),$("#fldNewProducLength").numberbox("clear"),$("#fldNewProductHeight").numberbox("clear"),$("#fldNewProductWeight").numberbox("clear"),$("#fldNewProductPrice1").numberbox("clear"),$("#fldNewProductPrice2").numberbox("clear"),$("#fldNewProductPrice3").numberbox("clear"),$("#fldNewProductPrice4").numberbox("clear"),$("#fldNewProductPrice5").numberbox("clear"),$("#fldNewProductPrice6").numberbox("clear"),$("#fldNewProductPrice7").numberbox("clear"),$("#fldNewProductPrice8").numberbox("clear"),$("#fldNewProductPrice9").numberbox("clear"),$("#fldNewProductPrice10").numberbox("clear"),$("#fldNewProductPrice11").numberbox("clear"),$("#fldNewProductPrice12").numberbox("clear"),$("#fldNewProductPrice13").numberbox("clear"),$("#fldNewProductPrice14").numberbox("clear"),$("#fldNewProductPrice15").numberbox("clear"),$("#fldNewProductAttrib1").textbox("clear"),$("#fldNewProductAttrib2").textbox("clear"),$("#fldNewProductAttrib3").textbox("clear"),$("#fldNewProductAttrib4").textbox("clear"),$("#fldNewProductAttrib5").textbox("clear")):_.isEmpty(o)||($("#fldNewProductCode").textbox("setValue",o.code),$("#fldNewProductName").textbox("setValue",o.name),$("#fldNewProductBarcode").textbox("setValue",o.barcode),$("#fldNewProductAltcode").textbox("setValue",o.altcode),$("#fldNewProductCostPrice").numberbox("setValue",o.costprice),$("#fldNewProductUOM").textbox("setValue",o.uom),$("#fldNewProductUOMSize").numberbox("setValue",o.uomsize),$("#cbNewProductClients").combotree("setValue",o.clientid),$("#cbNewProductActive").switchbutton("check",o.isactive),$("#cbNewProductBuyTaxCode").combobox("setValue",o.buytaxcodeid),$("#cbNewProductSellTaxCode").combobox("setValue",o.selltaxcodeid),$("#cbNewProductSalesAccount").combotree("setValue",o.costofgoodsaccountid),$("#cbNewProductIncomeAccount").combotree("setValue",o.incomeaccountid),$("#cbNewProductAssetAccount").combotree("setValue",o.assetaccountid),$("#cbNewProductBuildTemplate").combotree("setValue",o.buildtemplateid),$("#fldNewProductMinQty").numberbox("setValue",_.niceformatqty(o.minqty)),$("#fldNewProductWarnQty").numberbox("setValue",_.niceformatqty(o.warnqty)),$("#cbNewProductAlias").combobox("setValue",o.productaliasid),$("#cbNewProductLocation1").combotree("setValue",o.location1id),$("#cbNewProductLocation2").combotree("setValue",o.location2id),$("#fldNewProductWidth").numberbox("setValue",_.niceformatqty(o.width)),$("#fldNewProducLength").numberbox("setValue",_.niceformatqty(o.length)),$("#fldNewProductHeight").numberbox("setValue",_.niceformatqty(o.height)),$("#fldNewProductWeight").numberbox("setValue",_.niceformatqty(o.weight)),$("#fldNewProductPrice1").numberbox("setValue",_.niceformatqty(o.price1)),$("#fldNewProductPrice2").numberbox("setValue",_.niceformatqty(o.price2)),$("#fldNewProductPrice3").numberbox("setValue",_.niceformatqty(o.price3)),$("#fldNewProductPrice4").numberbox("setValue",_.niceformatqty(o.price4)),$("#fldNewProductPrice5").numberbox("setValue",_.niceformatqty(o.price5)),$("#fldNewProductPrice6").numberbox("setValue",_.niceformatqty(o.price6)),$("#fldNewProductPrice7").numberbox("setValue",_.niceformatqty(o.price7)),$("#fldNewProductPrice8").numberbox("setValue",_.niceformatqty(o.price8)),$("#fldNewProductPrice9").numberbox("setValue",_.niceformatqty(o.price9)),$("#fldNewProductPrice10").numberbox("setValue",_.niceformatqty(o.price10)),$("#fldNewProductPrice11").numberbox("setValue",_.niceformatqty(o.price11)),$("#fldNewProductPrice12").numberbox("setValue",_.niceformatqty(o.price12)),$("#fldNewProductPrice13").numberbox("setValue",_.niceformatqty(o.price13)),$("#fldNewProductPrice14").numberbox("setValue",_.niceformatqty(o.price14)),$("#fldNewProductPrice15").numberbox("setValue",_.niceformatqty(o.price15)),$("#fldNewProductAttrib1").textbox("setValue",o.attrib1),$("#fldNewProductAttrib2").textbox("setValue",o.attrib2),$("#fldNewProductAttrib3").textbox("setValue",o.attrib3),$("#fldNewProductAttrib4").textbox("setValue",o.attrib4),$("#fldNewProductAttrib5").textbox("setValue",o.attrib5),_.isBlank(o.barcode)||JsBarcode("#svgNewProductBarcode",o.barcode,{format:barcode_defaultformat,lineColor:barcode_colour,fontoptions:barcode_fontOptions,textmargin:barcode_textmargin,width:barcode_width,height:barcode_height}),$("#btnProductNewAdd").linkbutton("enable"),$("#dlgProductNew").dialog("setTitle","Modify "+o.name)),doTextboxFocus("fldNewProductCode")}function e(e,t){0<t.data.rs.length?$("#btnProductNewAdd").linkbutton("disable"):$("#btnProductNewAdd").linkbutton("enable")}function t(e,t){$("#dlgProductNew").dialog("close")}function i(e,t){$("#cbNewProductSalesAccount").combotree("loadData",cache_accounts),$("#cbNewProductIncomeAccount").combotree("loadData",cache_accounts),$("#cbNewProductAssetAccount").combotree("loadData",cache_accounts)}function a(e,t){$("#cbNewProductBuyTaxCode").combobox("loadData",cache_accounts),$("#cbNewProductSellTaxCode").combobox("loadData",cache_accounts)}function u(e,t){o=t.data.product,c()}function l(e,t){$("#fldNewProductBarcode").textbox("setValue",t.data.barcodeno)}function n(e,t){$("#divNewProductSupplierCodeG").datagrid("loadData",t.data.rs)}function s(e,t){t.data.productid==j&&doServerDataMessage("listproductpricing",{productid:j},{type:"refresh"})}function b(e,t){$("#divNewProductPricesG").datagrid("loadData",t.data.rs)}function f(e,t){doServerDataMessage("listproductcodes",{productid:j},{type:"refresh"})}function p(e,t){t.data.productid==j&&doServerDataMessage("listproductcodes",{productid:j},{type:"refresh"})}function m(e,t){j==t.data.productid&&doServerDataMessage("listproductimages",{productid:j},{type:"refresh"})}function P(e,t){var o=[];t.data.rs.forEach(function(e){var t=_.isNull(e.image)||_.isUndefined(e.image)?"":'<image src="'+e.image+'" width="35px">';console.log(t),o.push({id:doNiceId(e.id),name:doNiceString(e.name),description:doNiceString(e.description),mimetype:'<a href="javascript:void(0);" onClick="doThrowProductImage('+e.id+');">'+mapMimeTypeToImage(e.mimetype)+"</a>",size:doNiceString(e.size),isthumbnail:e.isthumbnail,image:t,date:doNiceDateModifiedOrCreated(e.datemodified,e.datecreated),by:doNiceModifiedBy(e.datemodified,e.usermodified,e.usercreated)})}),$("#divNewProductImagesG").datagrid("loadData",o)}function w(e,t){var o,d,r;"new"==t?(o=$("#cbNewProductSupplier").combobox("getValue"),d=$("#fldNewProductSupplierCode").textbox("getValue"),r=$("#fldNewProductSupplierBarcode").textbox("getValue"),_.isNull(j)||_.isBlank(d)||doServerDataMessage("newproductcode",{productid:j,supplierid:o,code:d,barcode:r},{type:"refresh"})):"clear"==t?$("#divNewProductSupplierCodeG").datagrid("clearSelections"):"remove"==t&&(doGridGetSelectedRowData("divNewProductSupplierCodeG",function(t){doPromptOkCancel("Remove code "+t.code+"?",function(e){e&&doServerDataMessage("expireproductcode",{productcodeid:t.id},{type:"refresh"})})})||doShowError("Please select an attachment to remove"))}function g(e,t){"new"==t?doServerDataMessage("newproductpricing",{productid:j},{type:"refresh"}):"clear"==t?$("#divNewProductPricesG").datagrid("clearSelections"):"edit"==t?doGridStartEdit("divNewProductPricesG",d,function(e,t){d=t,doGridGetEditor("divNewProductPricesG",d,"price",function(e){})}):"cancel"==t?d=doGridCancelEdit("divNewProductPricesG",d):"save"==t?(doGridEndEditGetRow("divNewProductPricesG",d,function(e){doServerDataMessage("saveproductpricing",{priceid:e.id,productid:j,clientid:e.clientid,minqty:e.minqty,maxqty:e.maxqty,price:e.price,price1:e.price1,price2:e.price2,price3:e.price3,price4:e.price4,price5:e.price5},{type:"refresh"})}),d=null):"remove"==t&&(doGridGetSelectedRowData("divNewProductPricesG",function(t){doPromptOkCancel("Remove selected price?",function(e){e&&doServerDataMessage("expireproductpricing",{priceid:t.id},{type:"refresh"})})})||doShowError("Please select a price to remove"))}function x(e,t){"clear"==t?$("#divNewProductImagesG").datagrid("clearSelections"):"edit"==t?doGridStartEdit("divNewProductImagesG",d,function(e,t){r=t,doGridGetEditor("divNewProductImagesG",r,"description",function(e){})}):"cancel"==t?r=doGridCancelEdit("divNewProductImagesG",d):"save"==t?(doGridEndEditGetRow("divNewProductImagesG",r,function(e){doServerDataMessage("saveproductimage",{productimageid:e.id,description:e.description,isthumbnail:e.isthumbnail},{type:"refresh"})}),r=null):"remove"==t?doGridGetSelectedRowData("divNewProductImagesG",function(t){doPromptOkCancel("Remove image "+t.description+"?",function(e){e&&doServerDataMessage("expireproductimage",{productimageid:t.id},{type:"refresh"})})})||doShowError("Please select an image to remove"):"download"==t&&doGridGetSelectedRowData("divNewProductImagesG",function(e){doThrowProductImage(e.id)})}$("#divEvents").on("checkproductcode",e),$("#divEvents").on("newproduct",t),$("#divEvents").on("saveproduct",t),$("#divEvents").on("listaccounts",i),$("#divEvents").on("listtaxcodes",a),$("#divEvents").on("loadproduct",u),$("#divEvents").on("posgenbarcode",l),$("#divEvents").on("listproductpricing",b),$("#divEvents").on("productpricingupdated",s),$("#divEvents").on("newproductcode",f),$("#divEvents").on("expireproductcode",f),$("#divEvents").on("listproductcodes",n),$("#divEvents").on("productcodecreated",p),$("#divEvents").on("productcodeexpired",p),$("#divEvents").on("listproductimages",P),$("#divEvents").on("productimagecreated",m),$("#divEvents").on("productimagesaved",m),$("#divEvents").on("productimageexpired",m),$("#divEvents").on("saveproductimage",m),$("#divEvents").on("expireproductimage",m),$("#divEvents").on("productcodepopup",w),$("#divEvents").on("pricingpopup",g),$("#divEvents").on("productimagespopup",x),$("#dlgProductNew").dialog({onClose:function(){$("#divEvents").off("checkproductcode",e),$("#divEvents").off("newproduct",t),$("#divEvents").off("saveproduct",t),$("#divEvents").off("listaccounts",i),$("#divEvents").off("listtaxcodes",a),$("#divEvents").off("loadproduct",u),$("#divEvents").off("posgenbarcode",l),$("#divEvents").off("listproductpricing",b),$("#divEvents").off("productpricingupdated",s),$("#divEvents").off("newproductcode",f),$("#divEvents").off("expireproductcode",f),$("#divEvents").off("listproductcodes",n),$("#divEvents").off("productcodecreated",p),$("#divEvents").off("productcodeexpired",p),$("#divEvents").off("listproductimages",P),$("#divEvents").off("productimagecreated",m),$("#divEvents").off("productimagesaved",m),$("#divEvents").off("productimageexpired",m),$("#divEvents").off("saveproductimage",m),$("#divEvents").off("expireproductimage",m),$("#divEvents").off("productcodepopup",w),$("#divEvents").off("pricingpopup",g),$("#divEvents").off("productimagespopup",x),$("#svgNewProductBarcode").empty()},onOpen:function(){selectedProductIdImageId=j,$("#fldNewProductCode").textbox({onChange:function(e,t){_.isBlank(e)?$("#btnProductNewCreate").linkbutton("disable"):e!=t&&doServerDataMessage("checkproductcode",{productid:j,code:e},{type:"refresh"})}}),$("#fldNewProductBarcode").textbox({onClickButton:function(){doServerDataMessage("posgenbarcode",{type:barcode_defaultformat},{type:"refresh"})},onChange:function(e,t){_.isBlank(e)?$("#svgNewProductBarcode").empty():e.length==barcode_defaultformat_length||e.length==barcode_defaultformat_length+1?JsBarcode("#svgNewProductBarcode",e,{format:barcode_defaultformat,lineColor:barcode_colour,fontoptions:barcode_fontOptions,textmargin:barcode_textmargin,width:barcode_width,height:barcode_height}):doMandatoryTextbox(barcode_defaultformat.toUpperCase()+" barcodes require "+barcode_defaultformat_length+" digits","fldNewProductBarcode")}}),$("#cbNewProductSupplier").combotree({valueField:"id",textField:"name",multiple:!1,data:cache_suppliers,limitToList:!0,onSelect:function(e){doServerDataMessage("loadsupplier",{supplierid:e.id},{type:"refresh"})}}),$("#fldNewProductSupplierCode").textbox({onChange:function(e,t){if(!_.isBlank(e)&&e!=t){var o=$("#divNewProductSupplierCodeG").datagrid("getData");if(o.rows){for(var d=-1,r=0;r<o.rows.length;r++)if(o.rows[r].code.toUpperCase()==e.toUpperCase()){d=r;break}if(-1!=d)return noty({text:"Product code ["+e+"] is already used",type:"error",timeout:4e3}),void $("#divNewProductSupplierCodeG").datagrid("selectRow",d)}doServerDataMessage("checkproductcode",{productid:j,code:e},{type:"refresh"})}}}),$("#fldNewProductSupplierBarcode").textbox({onChange:function(e,t){_.isBlank(e)||_.isBlank(e)||e.length!=barcode_defaultformat_length&&e.length!=barcode_defaultformat_length+1||JsBarcode("#svgNewProductSupplierBarcode",e,{format:barcode_defaultformat,lineColor:barcode_colour,fontoptions:barcode_fontOptions,textmargin:barcode_textmargin,width:barcode_width,height:barcode_height})}}),$("#cbNewProductClients").combotree({valueField:"id",textField:"name",data:cache_clients}),$("#cbNewProductBuyTaxCode").combobox({valueField:"id",textField:"name",data:cache_taxcodes}),$("#cbNewProductSellTaxCode").combobox({valueField:"id",textField:"name",data:cache_taxcodes}),$("#cbNewProductSalesAccount").combotree({valueField:"id",textField:"name",data:cache_accounts}),$("#cbNewProductIncomeAccount").combotree({valueField:"id",textField:"name",data:cache_accounts}),$("#cbNewProductAssetAccount").combotree({valueField:"id",textField:"name",data:cache_accounts}),$("#cbNewProductBuildTemplate").combotree({valueField:"id",textField:"name",data:cache_buildtemplates}),$("#cbNewProductAlias").combobox({valueField:"id",textField:"code",groupField:"productcategoryname",data:cache_products}),$("#cbNewProductLocation1").combotree({valueField:"id",textField:"name",data:cache_locations}),$("#cbNewProductLocation2").combotree({valueField:"id",textField:"name",data:cache_locations}),$("#divNewProductSupplierCodeG").datagrid({idField:"id",fitColumns:!0,singleSelect:!0,rownumbers:!0,striped:!0,toolbar:"#tbProductCodes",columns:[[{title:"Supplier",field:"supplierid",width:200,align:"left",resizable:!0,formatter:function(e,t){return doGetStringFromIdInObjArray(cache_suppliers,e)}},{title:"Code",field:"code",width:100,align:"left",resizable:!0},{title:"Barcode",field:"barcode",width:100,align:"left",resizable:!0}]],onDblClickCell:function(e,t,o){}}),$("#divNewProductPricesG").datagrid({idField:"id",fitColumns:!0,singleSelect:!0,rownumbers:!0,striped:!0,toolbar:"#tbPricing",columns:[[{title:"Client",field:"clientid",width:200,align:"left",resizable:!0,editor:{type:"combobox",options:{panelWidth:300,valueField:"id",textField:"name",data:cache_clients,onSelect:function(e){console.log(e)}}},formatter:function(e,t){return doGetStringFromIdInObjArray(cache_clients,e)}},{title:"Min Qty",field:"minqty",width:100,align:"right",resizable:!0,editor:{type:"numberbox",options:{groupSeparator:",",precision:0}},formatter:function(e,t,o){return _.niceformatqty(e)},align:"right"},{title:"Max Qty",field:"maxqty",width:100,align:"right",resizable:!0,editor:{type:"numberbox",options:{groupSeparator:",",precision:0}},formatter:function(e,t,o){return _.niceformatqty(e)},align:"right"},{title:"Price",field:"price",width:100,align:"right",resizable:!0,editor:{type:"numberbox",options:{groupSeparator:",",precision:2}},formatter:function(e,t,o){return _.niceformatnumber(e)},align:"right"},{title:"Date From",field:"datefrom",width:150,align:"right",resizable:!0,editor:{type:"datebox"},formatter:function(e,t,o){return _.nicejsdatetodisplay(e)},align:"right"},{title:"Date To",field:"dateto",width:150,align:"right",resizable:!0,editor:{type:"datebox"},formatter:function(e,t,o){return _.nicejsdatetodisplay(e)},align:"right"},{title:"Modified",field:"date",width:150,align:"right",resizable:!0,align:"right"},{title:"By",field:"by",width:200,align:"left",resizable:!0}]],onRowContextMenu:function(e,t,o){doGridContextMenu("divNewProductPricesG","divPricingMenuPopup",e,t,o)},onDblClickCell:function(e,o,t){doGridStartEdit("divNewProductPricesG",d,function(e,t){d=t,-1!=["modified","by"].indexOf(o)&&(o="minqty"),doGridGetEditor("divNewProductPricesG",d,o,function(e){})})}}),$("#divNewProductImagesG").datagrid({idField:"id",fitColumns:!0,singleSelect:!0,rownumbers:!1,striped:!0,toolbar:"#tbProductImages",columns:[[{title:"Name",field:"name",width:200,align:"left",resizable:!0},{title:"Description",field:"description",width:300,align:"left",resizable:!0,editor:"text"},{title:"Type",field:"mimetype",width:100,align:"center",resizable:!0},{title:"Size",field:"size",width:150,align:"right",resizable:!0,formatter:function(e,t){return filesize(e,{base:10})}},{title:"Thumbnail",field:"isthumbnail",width:150,align:"center",resizable:!0,editor:{type:"checkbox",options:{on:1,off:0}},formatter:function(e,t){return mapBoolToImage(e)}},{title:"Image",field:"image",width:50,align:"center",resizable:!0},{title:"Modified",field:"date",width:150,align:"right",resizable:!0},{title:"By",field:"by",width:200,align:"left",resizable:!0}]],onRowContextMenu:function(e,t,o){doGridContextMenu("divNewProductImagesG","divProductImagesMenuPopup",e,t,o)},onDblClickCell:function(e,t,o){doGridStartEdit("divNewProductImagesG",r,function(e,t){r=t,doGridGetEditor("divNewProductImagesG",r,"description",function(e){})})}}),$("#newproducttabs").tabs({selected:0}),H?$("#btnProductNewAdd").linkbutton({text:"Add"}):$("#btnProductNewAdd").linkbutton({text:"Save"}),_.isNull(j)?c():(doServerDataMessage("loadproduct",{productid:j},{type:"refresh"}),doServerDataMessage("listproductcodes",{productid:j},{type:"refresh"}),doServerDataMessage("listproductpricing",{productid:j},{type:"refresh"}),doServerDataMessage("listproductimages",{productid:j},{type:"refresh"}))},buttons:[{text:"Add",disabled:!0,id:"btnProductNewAdd",handler:function(){var e=$("#fldNewProductCode").textbox("getValue"),t=$("#fldNewProductName").textbox("getValue");if(_.isBlank(e)||_.isBlank(t))doMandatoryTextbox("Need at least a product code and name","fldNewProductCode");else{var o=$("#fldNewProductBarcode").textbox("getValue"),d=$("#fldNewProductAltcode").textbox("getValue"),r=$("#fldNewProductCostPrice").numberbox("getValue"),c=$("#fldNewProductUOM").textbox("getValue"),i=$("#fldNewProductUOMSize").numberbox("getValue"),a=doGetComboTreeSelectedId("cbNewProductClients"),u=doSwitchButtonChecked("cbNewProductActive"),l=$("#cbNewProductBuyTaxCode").combobox("getValue"),n=$("#cbNewProductSellTaxCode").combobox("getValue"),s=doGetComboTreeSelectedId("cbNewProductSalesAccount"),b=doGetComboTreeSelectedId("cbNewProductIncomeAccount"),f=doGetComboTreeSelectedId("cbNewProductAssetAccount"),p=doGetComboTreeSelectedId("cbNewProductBuildTemplate"),m=$("#fldNewProductMinQty").numberbox("getValue"),P=$("#fldNewProductWarnQty").numberbox("getValue"),w=$("#cbNewProductAlias").combobox("getValue"),g=$("#cbNewProductLocation1").combobox("getValue"),x=$("#cbNewProductLocation2").combobox("getValue"),N=$("#fldNewProductWidth").numberbox("getValue"),v=$("#fldNewProducLength").numberbox("getValue"),h=$("#fldNewProductHeight").numberbox("getValue"),y=$("#fldNewProductWeight").numberbox("getValue"),V=$("#fldNewProductPrice1").numberbox("getValue"),S=$("#fldNewProductPrice2").numberbox("getValue"),C=$("#fldNewProductPrice3").numberbox("getValue"),E=$("#fldNewProductPrice4").numberbox("getValue"),G=$("#fldNewProductPrice5").numberbox("getValue"),A=$("#fldNewProductPrice6").numberbox("getValue"),M=$("#fldNewProductPrice7").numberbox("getValue"),D=$("#fldNewProductPrice8").numberbox("getValue"),B=$("#fldNewProductPrice9").numberbox("getValue"),I=$("#fldNewProductPrice10").numberbox("getValue"),q=$("#fldNewProductPrice11").numberbox("getValue"),k=$("#fldNewProductPrice12").numberbox("getValue"),F=$("#fldNewProductPrice13").numberbox("getValue"),T=$("#fldNewProductPrice14").numberbox("getValue"),z=$("#fldNewProductPrice15").numberbox("getValue"),O=$("#fldNewProductAttrib1").textbox("getValue"),R=$("#fldNewProductAttrib2").textbox("getValue"),L=$("#fldNewProductAttrib3").textbox("getValue"),U=$("#fldNewProductAttrib4").textbox("getValue"),W=$("#fldNewProductAttrib5").textbox("getValue");H?doServerDataMessage("newproduct",{productcategoryid:Q,code:e,name:t,barcode:o,altcode:d,costprice:r,uom:c,uomsize:i,clientid:a,isactive:u,buytaxcodeid:l,selltaxcodeid:n,costofgoodsaccountid:s,incomeaccountid:b,assetaccountid:f,buildtemplateid:p,minqty:m,warnqty:P,productaliasid:w,location1id:g,location2id:x,width:N,length:v,height:h,weight:y,price1:V,price2:S,price3:C,price4:E,price5:G,price6:A,price7:M,price8:D,price9:B,price10:I,price11:q,price12:k,price13:F,price14:T,price15:z,attrib1:O,attrib2:R,attrib3:L,attrib4:U,attrib5:W},{type:"refresh"}):doServerDataMessage("saveproduct",{productid:j,productcategoryid:Q,name:t,code:e,barcode:o,altcode:d,costprice:r,uom:c,uomsize:i,clientid:a,isactive:u,buytaxcodeid:l,selltaxcodeid:n,costofgoodsaccountid:s,incomeaccountid:b,assetaccountid:f,buildtemplateid:p,minqty:m,warnqty:P,productaliasid:w,location1id:g,location2id:x,width:N,length:v,height:h,weight:y,price1:V,price2:S,price3:C,price4:E,price5:G,price6:A,price7:M,price8:D,price9:B,price10:I,price11:q,price12:k,price13:F,price14:T,price15:z,attrib1:O,attrib2:R,attrib3:L,attrib4:U,attrib5:W},{type:"refresh"})}}},{text:"Reset",handler:function(){c()}},{text:"Close",handler:function(){$("#dlgProductNew").dialog("close")}}]}).dialog("center").dialog("open")}