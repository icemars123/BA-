function doDlgEmailTemplate(i){var o={},e=null;function t(e,t){var a="";o=t.data.config,console.log(t),t.pdata.template==itype_order_order?a=o.emailordertemplate:t.pdata.template==itype_order_invoice?a=o.emailinvoicetemplate:t.pdata.template==itype_order_quote&&(a=o.emailquotetemplate),nicEditors.findEditor("divEmailTemplate").setContent(a)}function a(e,t){doShowSuccess("Successfully saved template"),$("#dlgEmailTemplate").dialog("close")}$("#divEvents").on("loademailtemplates",t),$("#divEvents").on("saveemailtemplates",a),$("#dlgEmailTemplate").dialog({onClose:function(){o={},e.removeInstance("divEmailTemplate"),$("#divEmailTemplate").html(""),e=null,$("#divEvents").off("loademailtemplates",t),$("#divEvents").off("saveemailtemplates",a)},onOpen:function(){_.isNull(e)&&(e=new nicEditor({fullPanel:!0,iconsPath:"/js/nicedit/nicEditorIcons.gif"}).panelInstance("divEmailTemplate",{hasPanel:!0})),doServerMessage("loademailtemplates",{type:"refresh",template:i})},buttons:[{text:"Save",handler:function(){var e=nicEditors.findEditor("divEmailTemplate").getContent(),t=i==itype_order_order?e:o.emailordertemplate,a=i==itype_order_invoice?e:o.emailinvoicetemplate,l=i==itype_order_quote?e:o.emailquotetemplate;doServerDataMessage("saveemailtemplates",{emailordertemplate:t,emailinvoicetemplate:a,emailquotetemplate:l},{type:"refresh"})}},{text:"Close",handler:function(){$("#dlgEmailTemplate").dialog("close")}}]}).dialog("center").dialog("open")}