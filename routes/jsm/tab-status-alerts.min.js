var statusAlertsTabWidgetsLoaded=!1;function doStatusAlertsTabWidgets(){var t=[{text:"New",iconCls:"icon-add",handler:a},{text:"Clear",iconCls:"icon-clear",handler:function(){$("#divStatusAlertsG").datagrid("clearSelections")}},{text:"Remove",iconCls:"icon-remove",handler:s}];function a(){doDlgAlertNew(null)}function s(){var e=$("#divStatusAlertsG").datagrid("getSelected");e?doPromptOkCancel("Remove alert for status "+doGetStringFromIdInObjArray(orderstatustypes,e.status)+" for user "+doGetUserNameFromUUID(e.uuid)+"?",function(t){t&&doServerDataMessage("expirestatusalert",{statusalertid:e.id},{type:"refresh"})}):doShowError("Please select a status alert to remove")}function e(t,e){doServerMessage("liststatusalerts",{type:"refresh",statusalertid:e.data.statusalertid})}function i(){$("#divStatusAlertsG").datagrid("reloadFooter",[{uname:'<span class="totals_footer">'+cache_statusalerts.length+" Alerts</span>"}])}$("#divEvents").on("statusalertspopup",function(t,e){"new"==e?a():"edit"==e?doEdit():"remove"==e&&s()}),statusAlertsTabWidgetsLoaded||(statusAlertsTabWidgetsLoaded=!0,$("#divEvents").on("liststatusalerts",function(t,e){var a=[];e.data.rs.forEach(function(t){a.push({id:doNiceId(t.id),uuid:doNiceId(t.uuid),status:t.status,email:doNiceString(t.email),mobile:doNiceString(t.mobile),date:doNiceDateModifiedOrCreated(t.datemodified,t.datecreated),by:doNiceModifiedBy(t.datemodified,t.usermodified,t.usercreated),statusname:doGetStringFromIdInObjArray(orderstatustypes,t.status),uname:doGetUserNameFromUUID(t.uuid)})}),$("#divStatusAlertsG").datagrid("loadData",a),i(),doGridSelectRowById("divStatusAlertsG",e.pdata.statusalertid)}),$("#divEvents").on("newstatusalert",e),$("#divEvents").on("savestatusalert",e),$("#divEvents").on("expirestatusalert",e),$("#divEvents").on("statusalertcreated",e),$("#divEvents").on("statusalertsaved",e),$("#divEvents").on("statusalertexpired",e),$("#divStatusAlertsG").datagrid({idField:"id",groupField:"uname",fitColumns:!1,singleSelect:!0,rownumbers:!0,striped:!0,toolbar:t,showFooter:!0,view:groupview,loader:function(t,e,a){e({total:cache_statusalerts.length,rows:cache_statusalerts}),i()},frozenColumns:[[{title:"User",field:"uname",width:300,align:"left",resizable:!0}]],columns:[[{title:"Status",field:"statusname",width:200,align:"left",resizable:!0},{title:"Email",field:"email",width:200,align:"left",resizable:!0},{title:"Mobile",field:"mobile",width:200,align:"left",resizable:!0},{title:"Modified",field:"modified",width:150,align:"right",resizable:!0},{title:"By",field:"by",width:200,align:"left",resizable:!0}]],groupFormatter:function(t,e){return t+" - "+e.length+" alert(s)"},onRowContextMenu:function(t,e,a){doGridContextMenu("divStatusAlertsG","divStatusAlertsMenuPopup",t,e,a)},onDblClickCell:function(t,e,a){doGetGridGetRowDataByIndex("divStatusAlertsG",t,function(t){doDlgAlertNew(t.id)})}}),doServerMessage("liststatusalerts",{type:"refresh"}))}