function doDlgInventoryNew(){function e(e,o){$("#cbInventoryNewLocations").combotree("loadData",cache_locations)}$("#divEvents").on("listlocations",e),$("#dlgInventoryNew").dialog({onClose:function(){$("#divEvents").off("listlocations",e)},onOpen:function(){$("#cbInventoryNewLocations").combotree({valueField:"id",textField:"name",data:cache_locations,onSelect:function(e){}}),$("#cbInventoryNewProducts").combobox({valueField:"id",textField:"code",groupField:"productcategoryname",data:cache_products,onSelect:function(e){}}),$("#cbInventoryNewTypes").combobox({valueField:"id",textField:"name",data:inventorytypes,onSelect:function(e){}}),$("#dtInventoryNewDateExpiry").datebox(),$("#dtInventoryNewDateProduction").datebox()},buttons:[{text:"Add",handler:function(){var e=doGetComboTreeSelectedId("cbInventoryNewLocations"),o=$("#cbInventoryNewProducts").combobox("getValue"),t=$("#fldInventoryNewQty").textbox("getValue"),n=$("#fldInventoryNewBatchno").textbox("getValue"),a=$("#dtInventoryNewDateExpiry").datebox("getValue"),r=$("#dtInventoryNewDateProduction").datebox("getValue"),c=$("#cbInventoryNewTypes").combobox("getValue"),d=$("#fldInventoryNewComment").textbox("getValue");_.isBlank(o)?doShowError("Please select a product to add to inventory"):_.isBlank(t)||_.toBigNum(t).isZero()?doShowError("Please enter a non zero qty"):_.isBlank(c)?doShowError("Please select an inventory adjustment type"):(doServerDataMessage("addinventory",{locationid:e,productid:o,qty:t,batchno:n,dateexpiry:a,dateproduction:r,type:c,comments:d},{type:"addinventory"}),$("#dlgInventoryNew").dialog("close"))}},{text:"Reset",handler:function(){$("#cbInventoryNewLocations").combotree("clear"),$("#cbInventoryNewProducts").combobox("clear"),$("#cbInventoryNewTypes").combobox("clear"),$("#fldInventoryNewQty").textbox("clear"),$("#fldInventoryNewBatchno").textbox("clear"),$("#fldInventoryNewComment").textbox("clear"),$("#dtInventoryNewDateExpiry").datebox("clear"),$("#dtInventoryNewDateProduction").datebox("clear")}},{text:"Close",handler:function(){$("#dlgInventoryNew").dialog("close")}}]}).dialog("center").dialog("open")}