function doDlgAlertNew(s){var o=_.isUndefined(s)||_.isNull(s),l={};function a(){o?($("#cbNewAlertUser").combobox("clear"),$("#cbNewAlertStatus").combobox("clear"),$("#fldNewAlertEmail").textbox("clear"),$("#fldNewAlertMobile").textbox("clear"),$("#btnAlertNewAdd").linkbutton("disable")):_.isEmpty(l)||($("#cbNewAlertUser").combobox("setValue",l.uuid),$("#cbNewAlertStatus").combobox("setValue",l.status),$("#fldNewAlertEmail").textbox("setValue",l.email),$("#fldNewAlertMobile").textbox("setValue",l.mobile),$("#btnAlertNewAdd").linkbutton("enable"),$("#dlgAlertNew").dialog("setTitle","Modify "+l.statusname)),doTextboxFocus("cbNewAlertUser")}function e(e,t){$("#dlgAlertNew").dialog("close")}function t(e,t){l=t.data.statusalert,a()}$("#divEvents").on("newstatusalert",e),$("#divEvents").on("savestatusalert",e),$("#divEvents").on("loadstatusalert",t),$("#dlgAlertNew").dialog({onClose:function(){$("#divEvents").off("newstatusalert",e),$("#divEvents").off("savestatusalert",e),$("#divEvents").off("loadstatusalert",t)},onOpen:function(){$("#cbNewAlertUser").combobox({valueField:"uuid",textField:"name",data:cache_users,onSelect:function(e){_.isBlank(e.uuid)?$("#btnAlertNewAdd").linkbutton("disable"):$("#btnAlertNewAdd").linkbutton("enable")}}),$("#cbNewAlertStatus").combobox({valueField:"id",textField:"name",data:orderstatustypes}),o?$("#btnAlertNewAdd").linkbutton({text:"Add"}):$("#btnAlertNewAdd").linkbutton({text:"Save"}),_.isUndefined(s)||_.isNull(s)?a():doServerDataMessage("loadstatusalert",{orderstatusalertid:s},{type:"refresh"})},buttons:[{text:"Add",disabled:!0,id:"btnAlertNewAdd",handler:function(){var e=$("#cbNewAlertUser").combobox("getValue"),t=$("#cbNewAlertStatus").combobox("getValue"),l=$("#fldNewAlertEmail").textbox("getValue"),a=$("#fldNewAlertMobile").textbox("getValue");_.isBlank(e)?doMandatoryTextbox("Please select user to send alert to","cbNewAlertUser"):(_.isBlank(t)&&(t=0),o?doServerDataMessage("newstatusalert",{useruuid:e,statusalertid:t,email:l,mobile:a},{type:"refresh"}):doServerDataMessage("savestatusalert",{orderstatusalertid:s,useruuid:e,statusalertid:t,email:l,mobile:a},{type:"refresh"}))}},{text:"Reset",handler:function(){a()}},{text:"Close",handler:function(){$("#dlgAlertNew").dialog("close")}}]}).dialog("center").dialog("open")}