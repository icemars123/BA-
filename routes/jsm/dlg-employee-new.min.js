function doDlgEmployeeNew(t,W){var P=_.isUndefined(W)||_.isNull(W),o={},a=[];function l(){if($("#cbNewEmployeeParent").combotree("setValue",t),P)$("#cbNewEmployeeTitle").combobox("clear"),$("#fldNewEmployeeFirstName").textbox("clear"),$("#fldNewEmployeeLastName").textbox("clear"),$("#fldNewEmployeeCode").textbox("clear"),$("#fldNewEmployeeAltCode").textbox("clear"),$("#fldNewEmployeeEmail").textbox("clear"),$("#fldNewEmployeeMobile").textbox("clear"),$("#cbNewEmployeeIsFemale").switchbutton("uncheck"),$("#fldNewEmployeeAddress1").textbox("clear"),$("#fldNewEmployeeAddress2").textbox("clear"),$("#fldNewEmployeeCity").textbox("clear"),$("#fldNewEmployeePostcode").textbox("clear"),$("#cbNewEmployeeCountry").combobox("clear"),$("#cbNewEmployeeState").combobox("clear"),$("#fldNewEmployeeBankName").textbox("clear"),$("#fldNewEmployeeBankBsb").textbox("clear"),$("#fldNewEmployeeBankAcctNo").textbox("clear"),$("#fldNewEmployeeBankAcctName").textbox("clear"),$("#fldNewEmployeeTaxFileNo").textbox("clear"),$("#cbNewEmployeeSuperfund").combobox("clear"),$("#cbNewEmployeeWageAccount").combotree("clear"),$("#fldNewEmployeeTaxTable").combobox("clear"),$("#fldNewEmployeeAmount").numberbox("clear"),$("#cbNewEmployeeRate").combobox("clear"),$("#cbNewEmployeeFrequency").combobox("clear"),$("#fldNewEmployeePeriod").numberbox("clear"),$("#cbNewEmployeeOvertime").switchbutton("uncheck"),$("#cbNewEmployeeType").combobox("clear"),$("#cbNewEmployeeStatus").combobox("clear"),$("#dtNewEmployeeDob").datebox("clear"),$("#dtNewEmployeeStartDate").datebox("clear"),$("#dtNewEmployeeEndDate").datebox("clear"),$("#btnEmployeeNewAdd").linkbutton("disable"),$("#fldNewEmployeeTaxTable").combobox("setValue",1),$("#cbNewEmployeeParent").combotree("setValue",t),$("#cbNewEmployeeCountry").combobox("setValue",defaultCountry),$("#tsSundayStart").timespinner("clear"),$("#tsSundayEnd").timespinner("clear"),$("#tsMondayStart").timespinner("clear"),$("#tsMondayEnd").timespinner("clear"),$("#tsTuesdayStart").timespinner("clear"),$("#tsTuesdayEnd").timespinner("clear"),$("#tsWednesdayStart").timespinner("clear"),$("#tsWednesdayEnd").timespinner("clear"),$("#tsThursdayStart").timespinner("clear"),$("#tsThursdayEnd").timespinner("clear"),$("#tsFridayStart").timespinner("clear"),$("#tsFridayEnd").timespinner("clear"),$("#tsSaturdayStart").timespinner("clear"),$("#tsSaturdayEnd").timespinner("clear");else if(!_.isEmpty(o)){$("#cbNewEmployeeTitle").combobox("setValue",o.title),$("#fldNewEmployeeFirstName").textbox("setValue",o.firstname),$("#fldNewEmployeeLastName").textbox("setValue",o.lastname),$("#fldNewEmployeeCode").textbox("setValue",o.code),$("#fldNewEmployeeAltCode").textbox("setValue",o.altcode),$("#fldNewEmployeeEmail").textbox("setValue",o.email1),$("#fldNewEmployeeMobile").textbox("setValue",o.phone1),doSetSwitchButton("cbNewEmployeeIsFemale",o.gender),$("#fldNewEmployeeAddress1").textbox("setValue",o.address1),$("#fldNewEmployeeAddress2").textbox("setValue",o.address2),$("#fldNewEmployeeCity").textbox("setValue",o.city),$("#fldNewEmployeePostcode").textbox("setValue",o.postcode),$("#cbNewEmployeeCountry").combobox("setValue",o.country),$("#cbNewEmployeeState").combobox("setValue",o.statename),$("#fldNewEmployeeBankName").textbox("setValue",o.bankname),$("#fldNewEmployeeBankBsb").textbox("setValue",o.bankbsb),$("#fldNewEmployeeBankAcctNo").textbox("setValue",o.bankaccountno),$("#fldNewEmployeeBankAcctName").textbox("setValue",o.bankaccountname),$("#fldNewEmployeeTaxFileNo").textbox("setValue",o.taxfileno),$("#cbNewEmployeeSuperfund").combobox("setValue",o.superfundid),$("#cbNewEmployeeWageAccount").combotree("setValue",o.wageaccountid),$("#fldNewEmployeeTaxTable").combobox("setValue",o.taxtable),$("#fldNewEmployeeAmount").numberbox("setValue",o.payamount),$("#cbNewEmployeeRate").combobox("setValue",o.payrate),$("#cbNewEmployeeFrequency").combobox("setValue",o.payfrequency),$("#fldNewEmployeePeriod").numberbox("setValue",o.paystdperiod),doSetSwitchButton("cbNewEmployeeOvertime",o.overtimeallowed),$("#cbNewEmployeeType").combobox("setValue",o.employmenttype),$("#cbNewEmployeeStatus").combobox("setValue",o.employmentstatus),$("#dtNewEmployeeDob").datebox("setValue",o.dob),$("#dtNewEmployeeStartDate").datebox("setValue",o.startdate),$("#dtNewEmployeeEndDate").datebox("setValue",o.enddate);var e=JSON.parse(o.workhours);_.isNull(e)||_.isEmpty(e)||($("#tsSundayStart").timespinner("setValue",e[0].start),$("#tsSundayEnd").timespinner("setValue",e[0].finish),$("#tsMondayStart").timespinner("setValue",e[1].start),$("#tsMondayEnd").timespinner("setValue",e[1].finish),$("#tsTuesdayStart").timespinner("setValue",e[2].start),$("#tsTuesdayEnd").timespinner("setValue",e[2].finish),$("#tsWednesdayStart").timespinner("setValue",e[3].start),$("#tsWednesdayEnd").timespinner("setValue",e[3].finish),$("#tsThursdayStart").timespinner("setValue",e[4].start),$("#tsThursdayEnd").timespinner("setValue",e[4].finish),$("#tsFridayStart").timespinner("setValue",e[5].start),$("#tsFridayEnd").timespinner("setValue",e[5].finish),$("#tsSaturdayStart").timespinner("setValue",e[6].start),$("#tsSaturdayEnd").timespinner("setValue",e[6].finish)),$("#btnEmployeeNewAdd").linkbutton("enable"),$("#dlgEmployeeNew").dialog("setTitle","Modify "+o.firstname+" "+o.lastname)}doTextboxFocus("fldNewEmployeeFirstName")}function e(e,t){0<t.data.rs.length?$("#btnEmployeeNewAdd").linkbutton("disable"):$("#btnEmployeeNewAdd").linkbutton("enable")}function n(e,t){$("#dlgEmployeeNew").dialog("close")}function d(e,t){o=t.data.employee,l()}function s(e,t){$("#cbNewEmployeeWageAccount").combotree("loadData",cache_accounts)}function m(e,t){$("#cbNewEmployeeSuperfund").combobox("loadData",cache_superfunds)}function i(e,t){$("#fldNewEmployeeCode").textbox("setValue",t.data.empno)}$("#divEvents").on("checkemployeecode",e),$("#divEvents").on("newemployee",n),$("#divEvents").on("saveemployee",n),$("#divEvents").on("loademployee",d),$("#divEvents").on("listaccounts",s),$("#divEvents").on("listsuperfunds",m),$("#divEvents").on("nextemployeecode",i),$("#dlgEmployeeNew").dialog({onClose:function(){$("#divEvents").off("checkemployeecode",e),$("#divEvents").off("newemployee",n),$("#divEvents").off("saveemployee",n),$("#divEvents").off("loademployee",d),$("#divEvents").off("listaccounts",s),$("#divEvents").off("listsuperfunds",m),$("#divEvents").off("nextemployeecode",i)},onOpen:function(){$("#cbNewEmployeeParent").combotree({valueField:"id",textField:"lastname",data:cache_employees}),$("#cbNewEmployeeTitle").combobox({valueField:"name",textField:"name",data:titles}),$("#fldNewEmployeeLastName").textbox({onChange:function(e,t){_.isBlank(e)?$("#btnEmployeeNewAdd").linkbutton("disable"):$("#btnEmployeeNewAdd").linkbutton("enable")}}),$("#fldNewEmployeeCode").textbox({onChange:function(e,t){_.isBlank(e)||e!=t&&doServerDataMessage("checkemployeecode",{employeeid:W,code:e},{type:"refresh"})}}),$("#cbNewEmployeeIsFemale").switchbutton({onText:"Yes",offText:"No",checked:!1}),$("#cbNewEmployeeCountry").combobox({valueField:"country",textField:"country",data:cache_countries,onSelect:function(e){a=doGetStatesFromCountry(e.country),$("#cbNewEmployeeState").combobox("loadData",a)}}),$("#cbNewEmployeeState").combobox({valueField:"state",textField:"state",data:a}),$("#cbNewEmployeeSuperfund").combobox({valueField:"id",textField:"name",data:cache_superfunds}),$("#cbNewEmployeeWageAccount").combotree({valueField:"id",textField:"name",data:cache_accounts}),$("#fldNewEmployeeTaxTable").combobox({valueField:"id",textField:"name",data:taxtabletypes}),$("#cbNewEmployeeRate").combobox({valueField:"id",textField:"name",data:payrates}),$("#cbNewEmployeeFrequency").combobox({valueField:"id",textField:"name",data:payfrequencies}),$("#cbNewEmployeeOvertime").switchbutton({onText:"Yes",offText:"No",checked:!1}),$("#cbNewEmployeeType").combobox({valueField:"id",textField:"name",data:employmenttypes}),$("#cbNewEmployeeStatus").combobox({valueField:"id",textField:"name",data:employmentstatuses}),$("#dtNewEmployeeDob").datebox(),$("#dtNewEmployeeStartDate").datebox(),$("#dtNewEmployeeEndDate").datebox(),P?$("#btnEmployeeNewAdd").linkbutton({text:"Add"}):$("#btnEmployeeNewAdd").linkbutton({text:"Save"}),_.isNull(W)?l():doServerDataMessage("loademployee",{employeeid:W},{type:"refresh"})},buttons:[{text:"Add",disabled:!0,id:"btnEmployeeNewAdd",handler:function(){var e=$("#fldNewEmployeeFirstName").textbox("getValue"),t=$("#fldNewEmployeeLastName").textbox("getValue"),o=$("#fldNewEmployeeCode").textbox("getValue");if(_.isBlank(t)||_.isBlank(e))doMandatoryTextbox("Please enter first and lastname","fldNewEmployeeFirstName");else{var a=doGetComboTreeSelectedId("cbNewEmployeeParent"),l=$("#cbNewEmployeeTitle").combobox("getValue"),n=$("#fldNewEmployeeAltCode").textbox("getValue"),d=$("#fldNewEmployeeEmail").textbox("getValue"),s=$("#fldNewEmployeeMobile").textbox("getValue"),m=doSwitchButtonChecked("cbNewEmployeeIsFemale")?1:0,i=$("#fldNewEmployeeAddress1").textbox("getValue"),c=$("#fldNewEmployeeAddress2").textbox("getValue"),b=$("#fldNewEmployeeCity").textbox("getValue"),r=$("#fldNewEmployeePostcode").textbox("getValue"),y=$("#cbNewEmployeeCountry").combobox("getValue"),p=$("#cbNewEmployeeState").combobox("getValue"),u=$("#fldNewEmployeeBankName").textbox("getValue"),x=$("#fldNewEmployeeBankBsb").textbox("getValue"),E=$("#fldNewEmployeeBankAcctNo").textbox("getValue"),N=$("#fldNewEmployeeBankAcctName").textbox("getValue"),w=$("#fldNewEmployeeTaxFileNo").textbox("getValue"),f=$("#cbNewEmployeeSuperfund").combobox("getValue"),V=$("#cbNewEmployeeWageAccount").combobox("getValue"),g=$("#fldNewEmployeeTaxTable").textbox("getValue"),S=$("#fldNewEmployeeAmount").numberbox("getValue"),h=$("#cbNewEmployeeRate").combobox("getValue"),v=$("#cbNewEmployeeFrequency").combobox("getValue"),k=$("#fldNewClientDaysCredit").numberbox("getValue"),F=doSwitchButtonChecked("cbNewEmployeeOvertime")?1:0,T=$("#cbNewEmployeeType").combobox("getValue"),A=$("#cbNewEmployeeStatus").combobox("getValue"),C=$("#dtNewEmployeeDob").datebox("getValue"),B=$("#dtNewEmployeeStartDate").datebox("getValue"),D=$("#dtNewEmployeeEndDate").datebox("getValue"),M=[{start:$("#tsSundayStart").timespinner("getValue"),finish:$("#tsSundayEnd").timespinner("getValue")},{start:$("#tsMondayStart").timespinner("getValue"),finish:$("#tsMondayEnd").timespinner("getValue")},{start:$("#tsTuesdayStart").timespinner("getValue"),finish:$("#tsTuesdayEnd").timespinner("getValue")},{start:$("#tsWednesdayStart").timespinner("getValue"),finish:$("#tsWednesdayEnd").timespinner("getValue")},{start:$("#tsThursdayStart").timespinner("getValue"),finish:$("#tsThursdayEnd").timespinner("getValue")},{start:$("#tsFridayStart").timespinner("getValue"),finish:$("#tsFridayEnd").timespinner("getValue")},{start:$("#tsSaturdayStart").timespinner("getValue"),finish:$("#tsSaturdayEnd").timespinner("getValue")}];P?doServerDataMessage("newemployee",{parentid:a,title:l,firstname:e,lastname:t,code:o,altcode:n,email1:d,phone1:s,gender:m,address1:i,address2:c,city:b,postcode:r,state:p,country:y,bankname:u,bankbsb:x,bankaccountno:E,bankaccountname:N,taxfileno:w,superfundid:f,wageaccountid:V,taxtable:g,payamount:S,payrate:h,payfrequency:v,paystdperiod:k,overtimeallowed:F,employmenttype:T,employmentstatus:A,dob:C,startdate:B,enddate:D,workhours:""},{type:"refresh"}):doServerDataMessage("saveemployee",{employeeid:W,parentid:a,title:l,firstname:e,lastname:t,code:o,altcode:n,email1:d,phone1:s,gender:m,address1:i,address2:c,city:b,postcode:r,state:p,country:y,bankname:u,bankbsb:x,bankaccountno:E,bankaccountname:N,taxfileno:w,superfundid:f,wageaccountid:V,taxtable:g,payamount:S,payrate:h,payfrequency:v,paystdperiod:k,overtimeallowed:F,employmenttype:T,employmentstatus:A,dob:C,startdate:B,enddate:D,workhours:JSON.stringify(M)},{type:"refresh"})}}},{text:"Reset",handler:function(){l()}},{text:"Close",handler:function(){$("#dlgEmployeeNew").dialog("close")}}]}).dialog("center").dialog("open")}