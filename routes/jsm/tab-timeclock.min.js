var timeclockTabWidgetsLoaded=!1;function doTimeclockTabWidgets(){timeclockTabWidgetsLoaded||($("#divEvents").on("newrtap",function(e,t){if(!_.isUndefined(t.data)){var i=$("#divIncomingG").datagrid("getRowIndex",t.data.tag);-1==i?$("#divIncomingG").datagrid("insertRow",{index:0,row:{tag:t.data.tag,name:t.data.lastname+", "+t.data.firstname,code:t.data.code,datecreated:t.data.datecreated}}):$("#divIncomingG").datagrid("updateRow",{index:i,row:{tag:t.data.tag,datecreated:t.data.datecreated}})}}),$("#divEvents").on("rtapinserted",function(e,t){primus.emit("listrtaps",{fguid:fguid,uuid:uuid,session:session,pdata:{type:"refresh"}})}),$("#divEvents").on("insertrtap",function(e,t){primus.emit("listrtaps",{fguid:fguid,uuid:uuid,session:session,pdata:{type:"refresh"}})}),$("#divEvents").on("listrtaps",function(e,t){$("#divIncomingG").datagrid("loadData",t.data.rs)}),timeclockTabWidgetsLoaded=!0,$("#divIncomingG").datagrid({idField:"tag",fitColumns:!0,singleSelect:!0,rownumbers:!0,striped:!0,toolbar:[{text:"Add",iconCls:"icon-add",handler:function(){doDlgTimeclockNew()}},{text:"Generate",iconCls:"icon-download",handler:function(){window.open("/gettaps","_blank")}},{text:"Period",iconCls:"icon-calendar",handler:function(){doDlgTimeclocPeriod()}},{text:"Refresh",iconCls:"icon-refreshlist",handler:function(){primus.emit("listrtaps",{fguid:fguid,uuid:uuid,session:session,pdata:{type:"refresh"}})}}],columns:[[{title:"TAG",field:"tag",width:200,align:"left",resizable:!0},{title:"Name",field:"name",width:250,align:"left",resizable:!0,formatter:function(e,t){return t.lastname+", "+t.firstname}},{title:"Code",field:"code",width:200,align:"left",resizable:!0},{title:"Date",field:"datecreated",width:180,align:"right",resizable:!0}]]}))}