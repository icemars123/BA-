exports.dropOrderAttachmentPost=function(o,n){var d={message:"Error writing file"};__.isUndefined(o.body)||__.isNull(o.body)?n.json({message:"No form to upload"}):__.isUndefined(o.body.orderid)||__.isNull(o.body.orderid)?n.json({message:"No file to upload"}):__.isUndefined(o.files)||__.isUndefined(o.files.file)||global.modorders.newOrderAttachment({filename:o.files.file.originalFilename,orderid:o.body.orderid,uuid:o.body.uuid,description:o.body.description,isthumbnail:o.body.isthumbnail,mimetype:o.files.file.type,size:o.files.file.size},function(e,i){if(e)n.json(d);else{var l=global.path.join(__dirname,global.doAttachmentImageURL(o.body.orderid,i,o.files.file.originalFilename,o.files.file.type));global.fs.rename(o.files.file.path,l,function(e){e?n.json(d):global.fs.unlink(o.files.file.path,function(){e||(d={id:i,filename:o.files.file.originalFilename}),n.json(d)})})}})};