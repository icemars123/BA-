var server="http://"+self.location.hostname+":"+self.location.port,buildno="1.0.57",geocoder=null,primus=null,firstconnection=!0,connected=!1,fguid="",uid="",uname="",uuid="",session="",isadmin=0,isclient=0,myperms={canvieworders:0,cancreateorders:0,canviewinvoices:0,cancreateinvoices:0,canviewproducts:0,cancreateproducts:0,canviewinventory:0,cancreateinventory:0,canviewpayroll:0,cancreatepayroll:0,canviewcodes:0,cancreatecodes:0,canviewclients:0,cancreateclients:0},tabs=null,graph=null,maxhistory=50,channels=[],inittasks=0,completedtasks=0,importtype="",tpccgpslat="-37.749451",tpccgpslon="145.030579",tpccorgid=5183,errcode_none=0,errcode_nodata=-1,errcode_missingparams=-2,errcode_fatal=-3,errcode_notloggedin=-4,errcode_sessionexpired=-5,errcode_resourceunavail=-6,errcode_dbunavail=-7,errcode_userexists=-8,errcode_dberr=-9,errcode_fileerr=-10,errcode_usernotregistered=-11,errcode_passwdhash=-12,errcode_invalidconnection=-13,errcode_invalidlogin=-14,errcode_missingurl=-15,errcode_smserror=-16,errcode_invalidsession=-17,errcode_invalidclient=-18,errcode_unablerestoresession=-19,errcode_committx=-20,errcode_jsonparse=-21,errcode_jsonstringify=-22,errcode_unablecreatenewuser=-23,errcode_unableloginuser=-24,errcode_unablesaveclient=-25,errcode_unablesaveproduct=-26,errcode_insufficientqty=-27,css_gridcol_batchno_expired="color: red; font-weight: bold;",css_gridcol_batchno="color: blue;",css_gridcol_qty_neg="color: red;",css_gridcol_client_price="color: blue; font-weight: bold;",itype_inventory_xfer=1,itype_inventory_adjust=2,itype_inventory_order=3,itype_inventory_stock=4,itype_inventory_build=5,itype_account_asset=1,itype_account_expense=2,itype_account_liability=3,itype_account_equity=4,itype_account_revenue=5,itype_account_costofgoodssold=6,itype_account_otherrevenue=7,itype_account_otherexpenses=8,itype_account_bank=99,itype_order_order=1,itype_order_invoice=2,itype_order_quote=3,itype_order_deliverydocket=4,uomtypes=["Bottle","Carton","Box","Palette","bbl","doz","floz","gal","kg","g","l","lb","m3","mg","mt","oz","ml","t"],accounttypes=[{name:"Assets",id:1},{name:"Expenses",id:2},{name:"Liabilities",id:3},{name:"Equities",id:4},{name:"Revenues",id:5},{name:"Cost of Goods Sold",id:6},{name:"Other Revenue",id:7},{name:"Other Expenses",id:8},{name:"Bank",id:99}],tstypes=[{name:"Base Pay",id:1},{name:"Overtime 1",id:2},{name:"Overtime 2",id:3},{name:"Overtime 3",id:4},{name:"Leave - Annual",id:5},{name:"Leave - Sick & Carers",id:6},{name:"Leave - Compassionate",id:7},{name:"Leave - Long Service",id:8},{name:"Leave - Maternity & Parental",id:9},{name:"Leave - Worker's Compensation",id:10},{name:"Leave - Community Service",id:11},{name:"Public Holiday",id:12},{name:"Other",id:13}],inventorytypes=[{name:"Transfer",id:1},{name:"Adjustment",id:2},{name:"Order",id:3},{name:"Stock",id:4},{name:"Build",id:5}],payrates=[{name:"Hourly",id:1},{name:"Daily",id:2},{name:"Weekly",id:3},{name:"Fortnightly",id:4},{name:"Monthly",id:5},{name:"Annual",id:6}],payfrequencies=[{name:"Weekly",id:1},{name:"Fortnightly",id:2},{name:"Monthly",id:3}],employmenttypes=[{name:"Full Time",id:1},{name:"Part Time",id:2},{name:"Casual",id:3},{name:"Fixed Term",id:4},{name:"Contract",id:5},{name:"Apprentice",id:6}],employmentstatuses=[{name:"Employed",id:1},{name:"Suspended",id:2},{name:"Leave",id:3}],paymenttypes=[{name:"Credit Card",id:1},{name:"Cheque",id:2},{name:"EFT",id:3},{name:"Cash",id:4},{name:"Other",id:5}],barcodetypes=[{id:"codabar"},{id:"code11"},{id:"code29"},{id:"code93"},{id:"code128"},{id:"ean8"},{id:"ean13"},{id:"std25"},{id:"int25"},{id:"msi"},{id:"datamatrix"}],orderstatustypes=[{name:"Quote",id:1},{name:"Order",id:2},{name:"Pending",id:3},{name:"Approved",id:4},{name:"Invoiced",id:5},{name:"Manufacturing",id:6},{name:"Picking",id:7},{name:"Shipped",id:8},{name:"On Hold",id:9},{name:"Paid",id:10},{name:"Completed",id:11},{name:"Received",id:12},{name:"Back Order",id:13},{name:"Artwork Approved",id:14},{name:"P.O. Received",id:15},{name:"Printing",id:16},{name:"Comment",id:99}],avatars=[{name:"Female 1",image:"mp-avatar1.png"},{name:"Female 2",image:"mp-avatar2.png"},{name:"Female 3",image:"mp-avatar3.png"},{name:"Female 4",image:"mp-avatar4.png"},{name:"Female 5",image:"mp-avatar5.png"},{name:"Female 6",image:"mp-avatar6.png"},{name:"Female 7",image:"mp-avatar7.png"},{name:"Female 8",image:"mp-avatar8.png"},{name:"Female 9",image:"mp-avatar9.png"},{name:"Female 10",image:"mp-avatar10.png"},{name:"Black",image:"mp-black.png"},{name:"Black Widow",image:"mp-blackwidow.png"},{name:"Blue",image:"mp-blue.png"},{name:"Brown",image:"mp-brown.png"},{name:"Dark Blue",image:"mp-darkblue.png"},{name:"Frankenstein",image:"mp-frankenstein.png"},{name:"Green",image:"mp-green.png"},{name:"Grey",image:"mp-grey.png"},{name:"Hulk",image:"mp-hulk.png"},{name:"iPad",image:"mp-ipad.png"},{name:"iPhone",image:"mp-iphone.png"},{name:"Iron Man",image:"mp-ironman.png"},{name:"Ian",image:"mp-iwu.png"},{name:"Mummy",image:"mp-mummy.png"},{name:"Mustard",image:"mp-mustard.png"},{name:"Orange",image:"mp-orange.png"},{name:"Pink",image:"mp-pink.png"},{name:"Pumpkin",image:"mp-pumpkin.png"},{name:"Purple",image:"mp-purple.png"},{name:"Red",image:"mp-red.png"},{name:"Skull",image:"mp-skull.png"},{name:"Steel Blue",image:"mp-steelblue.png"},{name:"Thor",image:"mp-thor.png"},{name:"Violet",image:"mp-violet.png"},{name:"Witch",image:"mp-witch.png"},{name:"Yellow",image:"mp-yellow.png"}],colour_white="#ffffff",colour_black="#000000",colour_steelblue="#4682b4",colour_maroon="#b03060",colour_forestgreen="#228b22",colour_dodgerblue="#1e90ff",colour_orangered="#ff4500",colour_bisque3="#cdb79e",colour_honeydew2="#e0eee0",colour_mistyrose="#ffe4e1",colour_lavender="#e6e6fa",colour_lemonchiffon="#fffacd",colour_slategrey="#708090",colour_snow4="#8b8989",colour_peachpuff3="#cdaf95",colour_cornflowerblue="#6495ed",colour_royalblue="#4169e1",colour_skyblue="#87ceeb",colour_darkturquoise="#00ced1",colour_mediumaqumarine="#66cdaa",colour_lawngreen="#7cfc00",colour_darkkhaki="#bdb76b",colour_seagreen="#2e8b57",colour_gold="#ffd700",colour_yellow="#ffff00",colour_goldenrod="#eee8aa",colour_rosybrown="#bc8f8f",colour_indianred="#cd5c5c",colour_sienna="#a0522d",colour_chocolate="#d2691e",colour_deeppink="#ff1493",colour_blueviolet="#8a2be2",colour_purple="#a020f0",colour_mediumorchid="#ba55d3",colour_darkorange="#ff8c00",colour_cadetblue=(colour_darkturquoise="#00ced1","#5f9ea0"),cache_accounts=[],cache_employees=[],cache_taxcodes=[],cache_superfunds=[],cache_clients=[],cache_suppliers=[],cache_locations=[],cache_productcategories=[],cache_orders=[],cache_invoices=[],cache_producttemplates=[],cache_products=[],cache_users=[],cache_invstock=[],cache_statusalerts=[],cache_exchangerates=[],cache_timesheets=[],cache_journals=[],cache_emails=[],cache_productsbycategory=[],cache_productsbytemplate=[],cache_productsbybuild=[],cache_productprices=[],cache_clientnotes=[],cache_clientattachments=[],cache_clientinvoices=[],cache_suppliernotes=[],cache_supplierattachments=[],cache_orderattachments=[],cache_userpermissions=[],cache_orderversions=[],cache_orderstatuses=[],cache_ordernotes=[],cache_orderproducts=[],cache_productpriceselection=[],cache_productselection=[],cache_printtemplates=[],cache_builds=[],cache_config={};function initMap(){geocoder=new google.maps.Geocoder,$.getScript("js/jquery.geocomplete.min.js",function(e,n,i){$("#fldOrderInvoicetoAddress1").geocomplete().bind("geocode:result",function(e,n){$("#fldOrderInvoicetoAddress1").val(n.address_components[0].long_name+" "+n.address_components[1].long_name),$("#fldOrderInvoicetoCity").val(n.address_components[2].long_name),doSelectDropDownList("fldOrderInvoicetoCountry",n.address_components[4].long_name),doSelectDropDownList("fldOrderInvoicetoState",n.address_components[3].long_name),$("#fldOrderInvoicetoPostcode").val(n.address_components[5].long_name)}),$("#fldOrderShiptoAddress1").geocomplete().bind("geocode:result",function(e,n){$("#fldOrderShiptoAddress1").val(n.address_components[0].long_name+" "+n.address_components[1].long_name),$("#fldOrderShiptoCity").val(n.address_components[2].long_name),doSelectDropDownList("fldOrderShiptoCountry",n.address_components[4].long_name),doSelectDropDownList("fldOrderShiptoState",n.address_components[3].long_name),$("#fldOrderShiptoPostcode").val(n.address_components[5].long_name)}),$("#fldMaintLocationAddress1").geocomplete().bind("geocode:result",function(e,n){$("#fldMaintLocationAddress1").val(n.address_components[0].long_name+" "+n.address_components[1].long_name),$("#fldMaintLocationCity").val(n.address_components[2].long_name),doSelectDropDownList("fldMaintLocationCountry",n.address_components[4].long_name),doSelectDropDownList("fldMaintLocationState",n.address_components[3].long_name),$("#fldMaintLocationPostcode").val(n.address_components[5].long_name),$("#fldMaintLocationGpslat").val(_.formatnumber(n.geometry.location.lat(),4)),$("#fldMaintLocationGpslon").val(_.formatnumber(n.geometry.location.lng(),4))}),$("#fldClientAddress1").geocomplete().bind("geocode:result",function(e,n){$("#fldClientAddress1").val(n.address_components[0].long_name+" "+n.address_components[1].long_name),$("#fldClientCity").val(n.address_components[2].long_name),doSelectDropDownList("fldClientCountry",n.address_components[4].long_name),doSelectDropDownList("fldClientState",n.address_components[3].long_name),$("#fldClientPostcode").val(n.address_components[5].long_name)}),$("#fldClientShippingAddress1").geocomplete().bind("geocode:result",function(e,n){$("#fldClientShippingAddress1").val(n.address_components[0].long_name+" "+n.address_components[1].long_name),$("#fldClientShippingCity").val(n.address_components[2].long_name),doSelectDropDownList("fldClientShippingCountry",n.address_components[4].long_name),doSelectDropDownList("fldClientShippingState",n.address_components[3].long_name),$("#fldClientShippingPostcode").val(n.address_components[5].long_name)}),$("#fldEmployeeAddress1").geocomplete().bind("geocode:result",function(e,n){$("#fldEmployeeAddress1").val(n.address_components[0].long_name+" "+n.address_components[1].long_name),$("#fldEmployeeCity").val(n.address_components[2].long_name),doSelectDropDownList("fldEmployeeCountry",n.address_components[4].long_name),doSelectDropDownList("fldEmployeeState",n.address_components[3].long_name),$("#fldEmployeePostcode").val(n.address_components[5].long_name)})})}function mapMimeTypeToImage(e){return'<img width="35" height="35" src="images/mimetypes/'+(_.hasstring(e,"image")?"mime-image.png":_.hasstring(e,"pdf")?"mime-pdf.png":_.hasstring(e,"excel")||_.hasstring(e,"spreadsheet")?"mime-spreadsheet.png":_.hasstring(e,"compress")?"mime-zip.png":_.hasstring(e,"document")?"mime-doc.png":_.hasstring(e,"powerpoint")?"mime-ppt.png":_.hasstring(e,"postscript")?"mime-vector.png":_.hasstring(e,"video")?"mime-video.png":_.hasstring(e,"audio")?"mime-audio.png":"mime-attachment.png")+'" />'}function mapBoolToImage(e){return'<img width="20" height="20" src="images/'+(_.isUndefined(e)||_.isNull(e)||!1===e||0===e||"0"===e?"blank.png":"tick.png")+'" />'}function mapAvatarToImage(e){return _.isUndefined(e)||_.isNull(e)||_.isBlank(e)?"":'<img width="23" height="30" src="images/'+e+'" />'}function mapUserStatusToImage(e){var n="ball-grey.png";return"online"==e?n="ball-green.png":"offline"==e&&(n="ball-black.png"),'<img width="30" height="30" src="images/led/'+n+'" />'}function mapUuidToImage(e){return""}function mapAccountTypeToImage(e){return"simonline"==status?"simonline.png":"simoffline"==status?"simoffline.png":"simactivated"==status?"simactivated.png":"simdeactivated"==status?"simdeactivated.png":"simnoconnection"==status?"simnoconnection.png":"simnotready.png"}function showBusy(){$("body").css("cursor","progress"),$("#divDashConnectionStatus").html('<img style="vertical-align: middle;" src="images/ajax_processing.gif" width="220" height="20"/>')}function showIdle(e){$("body").css("cursor","default"),connected?$("#divDashConnectionStatus").html('<img style="vertical-align: middle;" src="images/ajax_connected.gif" width="23" height="24"/>'):$("#divDashConnectionStatus").html('<img style="vertical-align: middle;" src="data:image/png;base64,'+b64disconnected+'" width="24" height="24"/> Waiting for server...')}function doScrollToTopOfPage(){$("html, body").animate({scrollTop:0},"fast")}function doDisableInput(e){$("#"+e).attr("disabled","disabled")}function doEnableInput(e){$("#"+e).removeAttr("disabled")}function doNiceDate(e){return _.isUndefined(e)||_.isNull(e)?"":moment(e).format("YYYY-MM-DD HH:mm:ss")}function doNiceDateModifiedOrCreated(e,n){return _.isUndefined(e)||_.isNull(e)?moment(n).format("YYYY-MM-DD HH:mm:ss"):moment(e).format("YYYY-MM-DD HH:mm:ss")}function doNiceModifiedBy(e,n,i){return _.isUndefined(e)||_.isNull(e)?_.titleize(i):_.titleize(n)}function doNiceTitleizeString(e){return _.isUndefined(e)||_.isNull(e)?"":_.titleize(e)}function doNiceString(e){return _.isUndefined(e)||_.isNull(e)||0==e.length?"":e}function doNiceId(e){return _.isUndefined(e)||_.isNull(e)?null:e}function doNiceIntToBool(e){return!_.isUndefined(e)&&!_.isNull(e)&&0!=e}function doSelectSalesTab(e){$("#as1tabs").tabs("select",2),$("#salestabs").tabs("select",e)}function doSelectInventoryTab(e){$("#as1tabs").tabs("select",4),$("#inventorytabs").tabs("select",e)}function doSelectBankingTab(e){$("#as1tabs").tabs("select",5),$("#bankingtabs").tabs("select",e)}function doSelectPayrollTab(e){$("#as1tabs").tabs("select",6),$("#payrolltabs").tabs("select",e)}function doSelectAccountsTab(e){$("#as1tabs").tabs("select",7),$("#accounttabs").tabs("select",e)}function doUpdateCacheName(e,n,i,t,o){e.forEach(function(e){e.id==n&&(e.name=i,_.isUndefined(t)||(e.date=t),_.isUndefined(o)||(e.by=o))})}function doUpdateCacheCode(e,n,i,t,o){var a=$.grep(e,function(e){return e.id==n});_.isNull(a)||1!=a.length||(a.code=i,_.isUndefined(t)||(a.date=t),_.isUndefined(o)||(a.by=o))}function doUpdateCacheParent(e,n,i,t,o){var a=$.grep(e,function(e){return e.id==n});_.isNull(a)||1!=a.length||(console.log("found account, updating..."),a.parentid=i,_.isUndefined(t)||(a.date=t),_.isUndefined(o)||(a.by=o))}function doGetUserNameFromUUID(n){var e=$.grep(cache_users,function(e){return e.uuid==n});return _.isNull(e)||0==e.length?"":e[0].name}function doGetCodeFromIdInObjArray(e,n){var i=$.grep(e,function(e){return e.id==n});return _.isNull(i)||0==i.length?"":i[0].code}function doGetStringFromIdInObjArray(e,n){var i=$.grep(e,function(e){return e.id==n});return _.isNull(i)||0==i.length?"":i[0].name}function doGetDescFromIdInObjArray(e,n){var i=$.grep(e,function(e){return e.id==n});return _.isNull(i)||0==i.length?"":i[0].description}function doGetIdFromStringInObjArray(e,n){var i=$.grep(e,function(e){return e.name==n});return _.isNull(i)||0==i.length?"":i[0].id}function doGetNameFromImage(n){var e=$.grep(avatars,function(e){return e.image==n});return _.isNull(e)||0==e.length?"":e[0].name}function doGetPercentFromTaxcode(n){var e=$.grep(cache_taxcodes,function(e){return e.id==n});return _.isNull(e)||0==e.length?0:e[0].percent}function doThrowOrderAttachment(e){var n=$("#ancSpare").get(0);n.target="_blank",n.href="/throworderattachment?orderattachmentid="+e+"&uuid="+uuid,n.click()}function doThrowClientAttachment(e){var n=$("#ancSpare").get(0);n.target="_blank",n.href="/throwclientattachment?clientattachmentid="+e+"&uuid="+uuid,n.click()}function doThrowPrintTemplate(e){var n=$("#ancSpare").get(0);n.target="_blank",n.href="/throwprinttemplate?printtemplateid="+e+"&uuid="+uuid,n.click()}function doLogin(){var e=$("#fldUid").val(),n=$("#fldPwd").val();primus.emit("login",{fguid:fguid,uid:e,pwd:n}),$("#divDashConnectionStatus").html('<img style="vertical-align: middle;" src="data:image/png;base64,'+b64gears+'" width="24" height="24"/> Authenticating...')}function doPromptOkCancel(e,n){noty({text:e,type:"warning",animation:{open:"animated flipInX",close:"animated flipOutX",easing:"swing",speed:500},buttons:[{addClass:"btn btn-primary",text:"Ok",onClick:function(e){e.close(),_.isUndefined(n)||_.isNull(n)||n(!0)}},{addClass:"btn btn-danger",text:"Cancel",onClick:function(e){e.close(),_.isUndefined(n)||_.isNull(n)||n(null)}}]})}function doPromptYesNoCancel(e,n){noty({text:e,type:"warning",animation:{open:"animated flipInX",close:"animated flipOutX",easing:"swing",speed:500},buttons:[{addClass:"btn btn-primary",text:"Yes",onClick:function(e){e.close(),_.isUndefined(n)||_.isNull(n)||n(!0)}},{addClass:"btn btn-primary",text:"No",onClick:function(e){e.close(),_.isUndefined(n)||_.isNull(n)||n(!1)}},{addClass:"btn btn-danger",text:"Cancel",onClick:function(e){e.close(),_.isUndefined(n)||_.isNull(n)||n(null)}}]})}function doPrompt2OptionsCancel(e,n,i,t){noty({text:e,type:"warning",animation:{open:"animated flipInX",close:"animated flipOutX",easing:"swing",speed:500},buttons:[{addClass:"btn btn-primary",text:n,onClick:function(e){e.close(),_.isUndefined(t)||_.isNull(t)||t(1)}},{addClass:"btn btn-primary",text:i,onClick:function(e){e.close(),_.isUndefined(t)||_.isNull(t)||t(2)}},{addClass:"btn btn-danger",text:"Cancel",onClick:function(e){e.close(),_.isUndefined(t)||_.isNull(t)||t(null)}}]})}function doPrompt3OptionsCancel(e,n,i,t,o){noty({text:e,type:"warning",animation:{open:"animated flipInX",close:"animated flipOutX",easing:"swing",speed:500},buttons:[{addClass:"btn btn-primary",text:n,onClick:function(e){e.close(),_.isUndefined(o)||_.isNull(o)||o(1)}},{addClass:"btn btn-primary",text:i,onClick:function(e){e.close(),_.isUndefined(o)||_.isNull(o)||o(2)}},{addClass:"btn btn-primary",text:t,onClick:function(e){e.close(),_.isUndefined(o)||_.isNull(o)||o(3)}},{addClass:"btn btn-danger",text:"Cancel",onClick:function(e){e.close(),_.isUndefined(o)||_.isNull(o)||o(null)}}]})}function doUpdateInitTasksProgress(){var e=++completedtasks/inittasks*100;$("#divProgress").progressbar("setValue",Math.ceil(e)),100==e&&($("#divProgress").hide(),$("#divDashConnectionStatus").html('<img style="vertical-align: middle;" src="images/ajax_connected.gif" width="23" height="24"/>'))}function doRefreshAll(){inittasks=5,completedtasks=0,$("#divProgress").progressbar({value:0}),primus.emit("listproductcategories",{fguid:fguid,uuid:uuid,session:session,pdata:{type:"refresh"}}),primus.emit("listproducts",{fguid:fguid,uuid:uuid,session:session,pdata:{type:"refresh"}}),primus.emit("listorders",{fguid:fguid,uuid:uuid,session:session,pdata:{type:"refresh"}}),primus.emit("listinvoices",{fguid:fguid,uuid:uuid,session:session,pdata:{type:"refresh"}}),primus.emit("loadconfig",{fguid:fguid,uuid:uuid,session:session,pdata:{type:"refresh"}})}function doSearchCodeNameInTree(e,n){var i,t="#"+e,o=$(t).treegrid("getData"),a=$(t).treegrid("getSelected"),l=_.isNull(a)?null:a.id;return i=function e(n,i){for(var t=null,o=0,a=n.length;o<a&&_.isNull(t);o++){var d=n[o];if(_.isNull(l)){var r=d.code.toUpperCase(),s=d.name.toUpperCase();-1<r.indexOf(i)||-1<s.indexOf(i)?t=d.id:!_.isUndefined(d.children)&&0<d.children.length&&(t=e(d.children,i))}else d.id==l&&(l=null),!_.isUndefined(d.children)&&0<d.children.length&&(t=e(d.children,i))}return t}(o,n.toUpperCase()),_.isNull(i)?noty({text:"No more occurrences found...",type:"warning",timeout:4e3}):($(t).treegrid("expandTo",i),$(t).treegrid("select",i)),i}function doExpandTreeToId(e,n){var i="#"+e;_.isUndefined(n)||_.isNull(n)||_.isNull($(i).treegrid("find",n))||($(i).treegrid("expandTo",n),$(i).treegrid("select",n))}function doFindParentNode(e,n){return function e(n,i){for(var t=null,o=0,a=n.length;o<a&&_.isNull(t);o++){var d=n[o];d.id==i?t=d:!_.isUndefined(d.children)&&0<d.children.length&&(t=e(d.children,i))}return t}(e,n)}function doSearchCodeNameInGrid(e,n,i){var t="#"+e,o=$(t).datagrid("getRows"),a=$(t).datagrid("getSelected"),d=_.isNull(a)?null:a.id,r=n.toUpperCase(),s=null,l=0;_.isNull(d)||(l=$(t).datagrid("getRowIndex",d)+1),_.isUndefined(i)&&_.isNull(i)||(i="code");for(var c=l,u=o.length;c<u;c++){var m=o[c],p=m[i].toUpperCase(),g=m.name.toUpperCase();if(-1<p.indexOf(r)||-1<g.indexOf(r)){s=c;break}}_.isNull(s)?noty({text:"No more occurrences found...",type:"warning",timeout:4e3}):$(t).datagrid("selectRow",s)}function doSetGridEditorValue(e,n,i,t){var o=$("#"+e).datagrid("getEditor",{index:n,field:i});_.isUndefined(o)||_.isNull(o)||$(o.target).val(t)}function doSetGridEditorComboValue(e,n,i,t){var o=$("#"+e).datagrid("getEditor",{index:n,field:i});_.isUndefined(o)||_.isNull(o)||$(o.target).combobox("select",t)}function doGetGridGetRowDataByIndex(e,n,i){var t,o="#"+e;$(o).datagrid("selectRow",null),t=$(o).datagrid("getSelected"),_.isNull(t)||_.isUndefined(i)||_.isNull(i)||i(t,null)}function doGetGridSelectedRowIndex(e){var n="#"+e,i=$(n).datagrid("getSelected");return _.isNull(i)||(index=$(n).datagrid("getRowIndex",i)),index}function doUpdateGridSelectedRow(e,n){var i="#"+e,t=null,o=$(i).datagrid("getSelected");return _.isNull(o)||(t=$(i).datagrid("getRowIndex",o),$(i).datagrid("updateRow",{index:t,row:n})),{row:o,index:t}}function doGridGetSelectedRowData(e,n){var i=$("#"+e).datagrid("getSelected");return!_.isNull(i)&&(_.isUndefined(n)||_.isNull(n)||n(i),!0)}function doGridStartEdit(e,n,i){var t="#"+e;if(_.isNull(n)){var o=$(t).datagrid("getSelected");_.isNull(o)||(n=$(t).datagrid("getRowIndex",o),$(t).datagrid("beginEdit",n),_.isUndefined(i)||_.isNull(i)||i(o,n))}return n}function doGridGetEditor(e,n,i,t){var o=$("#"+e).datagrid("getEditor",{index:n,field:i});_.isNull(o)||($(o.target).focus(),_.isUndefined(t)||_.isNull(t)||t(o))}function doGridCancelEdit(e,n,i){var t="#"+e;return _.isNull(n)||($(t).datagrid("cancelEdit",n),_.isUndefined(i)||_.isNull(i)||i()),null}function doGridEndEditGetRow(e,n,i){if(_.isNull(n))return!1;var t="#"+e;$(t).datagrid("endEdit",n),$(t).datagrid("selectRow",n);var o=$(t).datagrid("getSelected");return _.isNull(o)||_.isUndefined(i)||_.isNull(i)||i(o),!0}function doGridCalcTotals(e,n,i){var t=$("#"+e).datagrid("getData"),o=_.toBigNum(0),a=_.toBigNum(0),d=null,r=null;return _.isNull(t)||_.isNull(t.rows)||t.rows.forEach(function(e){d=_.toBigNum(e.colqty),r=_.toBigNum(e.colprice),o=o.plus(r.times(d)),a=a.plus(d)}),{price:o,qty:a,formattedprice:'<span class="totals_footer">'+_.formatnumber(o)+"</span>",formattedqty:'<span class="totals_footer">'+_.formatnumber(a)+"</span>"}}function doGridContextMenu(e,n,i,t,o){if(!_.isNull(o)){var a="#"+e;i.preventDefault(),$(a).datagrid("selectRow",t),$("#"+n).menu("show",{left:i.pageX,top:i.pageY})}}function doTreeGridGetSelectedRowData(e,n){var i=$("#"+e).treegrid("getSelected");return!_.isNull(i)&&(_.isUndefined(n)||_.isNull(n)||n(i),!0)}function doTreeGridStartEdit(e,n,i){var t="#"+e;if(_.isNull(n)){var o=$(t).treegrid("getSelected");_.isNull(o)||(n=o.id,$(t).treegrid("beginEdit",n),_.isUndefined(i)||_.isNull(i)||i(o,n))}return n}function doTreeGridGetSelectedRowEditor(e,n,i){var t="#"+e,o=$(t).treegrid("getSelected");if(!_.isNull(o)){var a=$(t).treegrid("getEditor",{id:o.id,field:n});_.isNull(a)||($(a.target).focus(),_.isUndefined(i)||_.isNull(i)||i(a))}}function doTreeGridGetEditor(e,n,i,t){var o=$("#"+e).treegrid("getEditor",{id:n,field:i});_.isNull(o)||($(o.target).focus(),_.isUndefined(t)||_.isNull(t)||t(o))}function doTreeGridEndEditGetRow(e,n,i){if(_.isNull(n))return!1;var t="#"+e;$(t).treegrid("endEdit",n),$(t).treegrid("select",n);var o=$(t).treegrid("getSelected");return _.isNull(o)||_.isUndefined(i)||_.isNull(i)||i(o),!0}function doTreeGridCancelEdit(e,n,i){var t="#"+e;return _.isNull(n)||($(t).treegrid("cancelEdit",n),_.isUndefined(i)||_.isNull(i)||i()),null}function doTreeGridContextMenu(e,n,i,t){if(!_.isNull(t)){var o="#"+e;i.preventDefault(),$(o).treegrid("select",t.id),$("#"+n).menu("show",{left:i.pageX,top:i.pageY})}}function doSwitchButtonChecked(e){return $("#"+e).switchbutton("options").checked}function doRemoveTBButton(e,n){for(var i=0,t=e.length;i<t;i++)if(e[i].text==n){e.splice(i,1);break}}function doTextboxFocus(e){$("#"+e).textbox("textbox").focus()}function doMandatoryTextbox(e,n){noty({text:e,type:"error",timeout:4e3}),doTextboxFocus(n)}_.mixin(_.str.exports()),_.mixin({escapeSingleQuotes:function(e){return _.isUndefined(e)||_.isNull(e)?"":_.isNumber(e)?e:e.replace(/'/g,"\\'")}}),_.mixin({escapeDoubleQuotes:function(e){return _.isUndefined(e)||_.isNull(e)?"":_.isNumber(e)?e:e.replace(/"/g,'\\"')}}),_.mixin({repeat:function(e,n){if(n<1)return"";for(var i="",t=e.valueOf();0<n;)1&n&&(i+=t),n>>=1,t+=t;return i}}),_.mixin({countslashes:function(e){var n=e.match(/\//gim);return _.isUndefined(n)||_.isNull(n)?0:n.length}}),_.mixin({reverseArray:function(e){var n=null,i=null;for(n=0,i=e.length-1;n<i;n+=1,i-=1){var t=e[n];e[n]=e[i],e[i]=t}return e}}),_.mixin({stripnonnumeric:function(e){e+="";for(var n=/^\d|\.|-$/,i="",t=0;t<e.length;t++)n.test(e.charAt(t))&&("."==e.charAt(t)&&-1!=i.indexOf(".")||"-"==e.charAt(t)&&0!=i.length||(i+=e.charAt(t)));return i}}),_.mixin({makeisomobile:function(e){var n=_.stripnonnumeric(e);return"0"==n.substring(0,1)&&(n="+61"+n.substring(1)),n}}),_.mixin({makeaddress:function(e){var n=!_.isUndefined(e.nice)&&!_.isNull(e.nice)&&e.nice,i=_.isUndefined(e.address1)||_.isNull(e.address1)?"":_.titleize(e.address1),t=_.isUndefined(e.city)||_.isNull(e.city)?"":_.titleize(e.city),o=_.isUndefined(e.state)||_.isNull(e.state)?"":_.titleize(e.state),a=_.isUndefined(e.postcode)||_.isNull(e.postcode)?"":e.postcode,d=_.isUndefined(e.country)||_.isNull(e.country)?"":_.titleize(e.country),r=i;return""!=t&&(r=""==r?t:n?r+",<br/>"+t:r+", "+t),""!=o&&(r=""==r?o:n?r+",<br/>"+o:r+", "+o),""!=a&&(r=""==r?a:r+" "+a),""!=d&&(r=""==r?d:n?r+",<br/>"+d:r+", "+d),r}}),_.mixin({humaniseSeconds:function(e){var n="",i=Math.floor(e/31536e3),t=Math.floor(e%31536e3/86400),o=Math.floor(e%31536e3%86400/3600),a=Math.floor(e%31536e3%86400%3600/60),d=Math.floor(e%31536e3%86400%3600%60);return 0<i&&(n=i,n+=1==i?" Year, ":" Years, "),0<t&&(n+=t,n+=1==t?" Day, ":" Days, "),0<o&&(n+=o,n+=1==o?" Hour, ":" Hours, "),0<a&&(n+=a,n+=1==a?" Minute, ":" Minutes, "),n+=d,n+=1==d?" Second":" Seconds"}}),_.mixin({totype:function(e){return{}.toString.call(e).match(/\s([a-zA-Z]+)/)[1].toLowerCase()}}),_.mixin({sanitiseAsNumeric:function(e,n){if(_.isUndefined(e)||_.isNull(e)||isNaN(e)||_.isBlank(e)||0==e)return 0;var i=_.isUndefined(n)?4:n;return e instanceof Decimal?e.toFixed(i):new Decimal(e).toFixed(i)}}),_.mixin({formatnumber:function(e,n,i){if(_.isUndefined(e)||_.isNull(e)||isNaN(e)||_.isBlank(e)||0==e)return _.isUndefined(i)||1==i?"":0;var t=_.isUndefined(n)?4:n;return e instanceof Decimal?e.toFixed(t):new Decimal(e).toFixed(t)}}),_.mixin({formatinteger:function(e){return _.isUndefined(e)||_.isNull(e)||isNaN(e)||_.isBlank(e)||0==e?"":e instanceof Decimal?e.toFixed(0):new Decimal(e).toFixed(0)}}),_.mixin({toBigNum:function(e){return _.isUndefined(e)||_.isNull(e)||isNaN(e)||_.isBlank(e)||0==e?new Decimal(0):e instanceof Decimal?e:new Decimal(e)}}),_.mixin({hasstring:function(e,n){return-1<e.indexOf(n)}}),_.mixin({nicedatetodisplay:function(e){return _.isUndefined(e)||_.isNull(e)?"":moment(e).format("YYYY-MM-DD")}});