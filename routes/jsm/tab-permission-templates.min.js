var permissiontemplatesTabWidgetsLoaded=!1;function doPermissionTemplatesTabSearch(e,s){doSearchCodeNameInTree("divPermissionTemplatesTG",e)}function doPermissionTemplatesTabWidgets(){function e(e,s){doServerMessage("listpermissiontemplates",{type:"refresh",permissiontemplateid:s.data.permissiontemplateid})}permissiontemplatesTabWidgetsLoaded||(permissiontemplatesTabWidgetsLoaded=!0,$("#divEvents").on("listpermissiontemplates",function(e,s){$("#divPermissionTemplatesTG").treegrid("reload"),console.log(s.pdata.permissiontemplateid),doExpandTreeToId("divPermissionTemplatesTG",s.pdata.permissiontemplateid)}),$("#divEvents").on("newpermissiontemplate",e),$("#divEvents").on("savepermissiontemplate",e),$("#divEvents").on("expirepermissiontemplate",e),$("#divEvents").on("permissiontemplatesaved",e),$("#divEvents").on("permissiontemplatescreated",e),$("#divEvents").on("permissiontemplateexpired",e),$("#divEvents").on("permissiontemplatespopup",function(e,s){var t;"newroot"==s?doNewRoot():"new"==s?doDlgPermissionTemplateNew(null,null):"clear"==s?$("#divPermissionTemplatesTG").treegrid("unselectAll"):"remove"==s&&((t=$("#divPermissionTemplatesTG").treegrid("getSelected"))?doPromptYesNoCancel("Remove "+t.name+" and ALL sub permission templates (Yes) or ONLY this template (No)?",function(e){_.isNull(e)||doServerDataMessage("expirepermissiontemplate",{permissiontemplateid:t.id,cascade:e},{type:"refresh"})}):doShowError("Please select an template to remove"))}),$("#divPermissionTemplatesTG").treegrid({idField:"id",treeField:"name",lines:!0,collapsible:!0,fitColumns:!1,autoRowHeight:!1,rownumbers:!0,striped:!0,toolbar:"#tbPermissionTemplates",showFooter:!0,sortName:"name",sortOrder:"asc",remoteSort:!1,multiSort:!0,loader:function(e,s,t){s({total:cache_permissiontemplates.length,rows:cache_permissiontemplates}),console.log("Cache_permissiontemplates: "+cache_permissiontemplates.length),$("#divPermissionTemplatesTG").treegrid("reloadFooter",[{name:'<span class="totals_footer">'+doGetCountTreeArray(cache_permissiontemplates)+" Templates</span>"}])},frozenColumns:[[{title:"Name",field:"name",width:"100%",align:"left",resizable:!0,editor:"text",sortable:!0}]],columns:[],onContextMenu:function(e,s){doTreeGridContextMenu("divPermissionTemplatesTG","divPermissionTemplatesMenuPopup",e,s)},onLoadSuccess:function(e){$(this).treegrid("enableDnd")},onDblClickCell:function(e,s){},onBeforeDrag:function(e){return!0},onDragOver:function(e,s){return!_.isUN(e)},onBeforeDrop:function(e,s,t){return!0},onDblClickCell:function(e,s){doDlgPermissionTemplateNew(null,s.id),console.log("id: "+s.id)}}))}