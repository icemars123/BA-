var permissiontemplatesTabWidgetsLoaded=!1;function doPermissionTemplatesTabSearch(d,c){doSearchCodeNameInTree("divPermissionTemplatesTG",d)}
function doPermissionTemplatesTabWidgets(){function d(){var b=$("#divPermissionTemplatesTG").treegrid("getSelected");b?doPromptYesNoCancel("Remove "+b.name+" and ALL sub permission templates (Yes) or ONLY this template (No)?",function(a){_.isNull(a)||doServerDataMessage("expirepermissiontemplate",{permissiontemplateid:b.id,cascade:a},{type:"refresh"})}):doShowError("Please select an template to remove")}function c(b,a){doServerMessage("listpermissiontemplates",{type:"refresh",permissiontemplateid:a.data.permissiontemplateid})}
permissiontemplatesTabWidgetsLoaded||(permissiontemplatesTabWidgetsLoaded=!0,$("#divEvents").on("listpermissiontemplates",function(b,a){$("#divPermissionTemplatesTG").treegrid("reload");console.log(a.pdata.permissiontemplateid);doExpandTreeToId("divPermissionTemplatesTG",a.pdata.permissiontemplateid)}),$("#divEvents").on("newpermissiontemplate",c),$("#divEvents").on("savepermissiontemplate",c),$("#divEvents").on("expirepermissiontemplate",c),$("#divEvents").on("permissiontemplatesaved",c),$("#divEvents").on("permissiontemplatescreated",
c),$("#divEvents").on("permissiontemplateexpired",c),$("#divEvents").on("permissiontemplatespopup",function(b,a){"newroot"==a?doNewRoot():"new"==a?doDlgPermissionTemplateNew(null,null):"clear"==a?$("#divPermissionTemplatesTG").treegrid("unselectAll"):"remove"==a&&d()}),$("#divPermissionTemplatesTG").treegrid({idField:"id",treeField:"name",lines:!0,collapsible:!0,fitColumns:!1,autoRowHeight:!1,rownumbers:!0,striped:!0,toolbar:"#tbPermissionTemplates",showFooter:!0,sortName:"name",sortOrder:"asc",remoteSort:!1,
multiSort:!0,loader:function(b,a,c){a({total:cache_permissiontemplates.length,rows:cache_permissiontemplates});console.log("Cache_permissiontemplates: "+cache_permissiontemplates.length);$("#divPermissionTemplatesTG").treegrid("reloadFooter",[{name:'<span class="totals_footer">'+doGetCountTreeArray(cache_permissiontemplates)+" Templates</span>"}])},frozenColumns:[[{title:"Name",field:"name",width:"100%",align:"left",resizable:!0,editor:"text",sortable:!0}]],columns:[],onContextMenu:function(b,a){doTreeGridContextMenu("divPermissionTemplatesTG",
"divPermissionTemplatesMenuPopup",b,a)},onLoadSuccess:function(b){$(this).treegrid("enableDnd")},onBeforeDrag:function(b){return!0},onDragOver:function(b,a){return _.isUN(b)?!1:!0},onBeforeDrop:function(b,a,c){return!0},onDblClickCell:function(b,a){doDlgPermissionTemplateNew(null,a.id);console.log("id: "+a.id)}}))};
