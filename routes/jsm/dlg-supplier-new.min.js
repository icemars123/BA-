function doDlgSupplierNew(e,R){var Y=_.isUndefined(R)||_.isNull(R),l={},t=[],o=[];function i(){$("#cbNewSupplierParent").combotree("setValue",e),Y?($("#fldNewSupplierName").textbox("clear"),$("#fldNewSupplierCode").textbox("clear"),$("#fldNewSupplierContact1").textbox("clear"),$("#fldNewSupplierContact2").textbox("clear"),$("#fldNewCSupplierEmail1").textbox("clear"),$("#fldNewSupplierUrl1").textbox("clear"),$("#fldNewSupplierPhone1").textbox("clear"),$("#fldNewSupplierFax1").textbox("clear"),$("#fldNewSupplierAddress1").textbox("clear"),$("#fldNewSupplierAddress2").textbox("clear"),$("#fldNewSupplierAddress3").textbox("clear"),$("#fldNewSupplierAddress4").textbox("clear"),$("#fldNewSupplierCity").textbox("clear"),$("#fldNewSupplierPostcode").textbox("clear"),$("#cbNewSupplierCountry").combobox("clear"),$("#cbNewSupplierState").combobox("clear"),$("#fldNewSupplierShippingAddress1").textbox("clear"),$("#fldNewSupplierShippingAddress2").textbox("clear"),$("#fldNewSupplierShippingAddress3").textbox("clear"),$("#fldNewSupplierShippingAddress4").textbox("clear"),$("#fldNewSupplierShippingCity").textbox("clear"),$("#fldNewSupplierShippingPostcode").textbox("clear"),$("#cbNewSupplierShippingCountry").combobox("clear"),$("#cbNewSupplierShippingState").combobox("clear"),$("#fldNewSupplierBankName").textbox("clear"),$("#fldNewSupplierBankBsb").textbox("clear"),$("#fldNewSupplierBankAcctNo").textbox("clear"),$("#fldNewSupplierBankAcctName").textbox("clear"),$("#fldNewSupplierDaysCredit").numberbox("clear"),$("#fldNewSupplierLineLimit").numberbox("clear"),$("#fldNewSupplierOrderLimit").numberbox("clear"),$("#fldNewSupplierCreditLimit").numberbox("clear"),$("#fldNewSupplierAcn").textbox("clear"),$("#fldNewSupplierAbn").textbox("clear"),$("#fldNewSupplierHsCode").textbox("clear"),$("#fldNewSupplierCustom1").textbox("clear"),$("#fldNewSupplierCustom2").textbox("clear"),$("#cbNewSupplierSalesAccount").combotree("clear"),$("#cbNewSupplierIncomeAccount").combotree("clear"),$("#cbNewSupplierExpenseAccount").combotree("clear"),$("#cbNewSupplierAssetAccount").combotree("clear"),$("#btnSupplierNewAdd").linkbutton("disable"),$("#cbNewSupplierCountry").combobox("setValue",defaultCountry),$("#cbNewSupplierShippingCountry").combobox("setValue",defaultCountry)):_.isEmpty(l)||($("#fldNewSupplierName").textbox("setValue",l.name),$("#fldNewSupplierCode").textbox("setValue",l.code),$("#fldNewSupplierContact1").textbox("setValue",l.contact1),$("#fldNewSupplierContact2").textbox("setValue",l.contact2),$("#fldNewSupplierEmail1").textbox("setValue",l.email1),$("#fldNewSupplierUrl1").textbox("setValue",l.url1),$("#fldNewSupplierPhone1").textbox("setValue",l.phone1),$("#fldNewSupplierFax1").textbox("setValue",l.fax1),$("#fldNewSupplierAddress1").textbox("setValue",l.address1),$("#fldNewSupplierAddress2").textbox("setValue",l.address2),$("#fldNewSupplierAddress3").textbox("setValue",l.address3),$("#fldNewSupplierAddress4").textbox("setValue",l.address4),$("#fldNewSupplierCity").textbox("setValue",l.city),$("#fldNewSupplierPostcode").textbox("setValue",l.postcode),$("#cbNewSupplierCountry").combobox("setValue",l.country),$("#cbNewSupplierState").combobox("setValue",l.state),$("#fldNewSupplierShippingAddress1").textbox("setValue",l.shipaddress1),$("#fldNewSupplierShippingAddress2").textbox("setValue",l.shipaddress2),$("#fldNewSupplierShippingAddress3").textbox("setValue",l.shipaddress3),$("#fldNewSupplierShippingAddress4").textbox("setValue",l.shipaddress4),$("#fldNewSupplierShippingCity").textbox("setValue",l.shipcity),$("#fldNewSupplierShippingPostcode").textbox("setValue",l.shippostcode),$("#cbNewSupplierShippingCountry").combobox("setValue",l.shipcountry),$("#cbNewSupplierShippingState").combobox("setValue",l.shipstate),$("#fldNewSupplierBankName").textbox("setValue",l.bankname),$("#fldNewSupplierBankBsb").textbox("setValue",l.bankbsb),$("#fldNewSupplierBankAcctNo").textbox("setValue",l.bankaccountno),$("#fldNewSupplierBankAcctName").textbox("setValue",l.banlaccountname),$("#fldNewSupplierDaysCredit").numberbox("setValue",l.dayscredit),$("#fldNewSupplierLineLimit").numberbox("setValue",l.linelimit),$("#fldNewSupplierOrderLimit").numberbox("setValue",l.orderlimit),$("#fldNewSupplierCreditLimit").numberbox("setValue",l.creditlimit),$("#fldNewSupplierAcn").textbox("setValue",l.acn),$("#fldNewSupplierAbn").textbox("setValue",l.abn),$("#fldNewSupplierHsCode").textbox("setValue",l.hscode),$("#fldNewSupplierCustom1").textbox("setValue",l.custcode1),$("#fldNewSupplierCustom2").textbox("setValue",l.custcode2),$("#cbNewSupplierSalesAccount").combotree("setValue",l.costofgoodsaccountid),$("#cbNewSupplierIncomeAccount").combotree("setValue",l.incomeaccountid),$("#cbNewSupplierExpenseAccount").combotree("setValue",l.expenseaccountid),$("#cbNewSupplierAssetAccount").combotree("setValue",l.assetaccountid),$("#btnSupplierNewAdd").linkbutton("enable"),$("#dlgSupplierNew").dialog("setTitle","Modify "+l.name)),doTextboxFocus("fldNewSupplierName")}function p(e,t){var l=t.data.rs;0<l.length?(doShowError("Supplier code ["+l[0].code+"] is already assigned to ["+l[0].name+"]"),$("#btnSupplierNewAdd").linkbutton("disable")):$("#btnSupplierNewAdd").linkbutton("enable")}function d(e,t){$("#dlgSupplierNew").dialog("close")}function r(e,t){l=t.data.supplier,i()}$("#divEvents").on("checksuppliercode",p),$("#divEvents").on("newsupplier",d),$("#divEvents").on("savesupplier",d),$("#divEvents").on("loadsupplier",r),$("#dlgSupplierNew").dialog({onClose:function(){$("#divEvents").off("checksuppliercode",p),$("#divEvents").off("newsupplier",d),$("#divEvents").off("savesupplier",d),$("#divEvents").off("loadsupplier",r)},onOpen:function(){$("#cbNewSupplierParent").combotree({valueField:"id",textField:"name",data:cache_suppliers}),$("#fldNewSupplierCode").textbox({onChange:function(e,t){_.isBlank(e)?$("#btnSupplierNewAdd").linkbutton("disable"):e!=t&&doServerDataMessage("checksuppliercode",{supplierid:R,code:e},{type:"refresh"})}}),$("#cbNewSupplierIsActive").switchbutton({checked:!0,onText:"Yes",offText:"No"}),$("#cbNewSupplierCountry").combobox({valueField:"country",textField:"country",limitToList:!0,data:cache_countries,onSelect:function(e){t=doGetStatesFromCountry(e.country),$("#cbNewSupplierState").combobox("loadData",t)}}),$("#cbNewSupplierShippingCountry").combobox({valueField:"country",textField:"country",limitToList:!0,data:cache_countries,onSelect:function(e){o=doGetStatesFromCountry(e.country),$("#cbNewSupplierShippingState").combobox("loadData",o)}}),$("#cbNewSupplierState").combobox({valueField:"state",textField:"state",limitToList:!0,data:t}),$("#cbNewSupplierShippingState").combobox({valueField:"state",textField:"state",limitToList:!0,data:o}),$("#cbNewSupplierSalesAccount").combotree({valueField:"id",textField:"name",data:cache_accounts}),$("#cbNewSupplierIncomeAccount").combotree({valueField:"id",textField:"name",data:cache_accounts}),$("#cbNewSupplierExpenseAccount").combotree({valueField:"id",textField:"name",data:cache_accounts}),$("#cbNewSupplierAssetAccount").combotree({valueField:"id",textField:"name",data:cache_accounts}),Y?$("#btnSupplierNewAdd").linkbutton({text:"Add"}):$("#btnSupplierNewAdd").linkbutton({text:"Save"}),_.isUndefined(R)||_.isNull(R)?i():doServerDataMessage("loadsupplier",{supplierid:R},{type:"refresh"})},buttons:[{text:"Add",disabled:!0,id:"btnSupplierNewAdd",handler:function(){var e=doGetComboTreeSelectedId("cbNewSupplierParent"),t=$("#fldNewSupplierName").textbox("getValue"),l=$("#fldNewSupplierCode").textbox("getValue"),o=$("#fldNewCSupplierEmail1").textbox("getValue"),i=$("#fldNewSupplierUrl1").textbox("getValue"),p=$("#fldNewSupplierPhone1").textbox("getValue"),d=$("#fldNewSupplierFax1").textbox("getValue"),r=$("#fldNewSupplierContact1").textbox("getValue"),a=$("#fldNewSupplierContact2").textbox("getValue"),u=$("#fldNewSupplierBankName").textbox("getValue"),c=$("#fldNewSupplierBankBsb").textbox("getValue"),s=$("#fldNewSupplierBankAcctNo").textbox("getValue"),n=$("#fldNewSupplierBankAcctName").textbox("getValue"),b=$("#fldNewSupplierAddress1").textbox("getValue"),x=$("#fldNewSupplierShippingAddress2").textbox("getValue"),S=$("#fldNewSupplierShippingAddress3").textbox("getValue"),N=$("#fldNewSupplierShippingAddress4").textbox("getValue"),w=$("#fldNewSupplierShippingCity").textbox("getValue"),f=$("#fldNewSupplierShippingPostcode").textbox("getValue"),m=$("#cbNewSupplierShippingCountry").combobox("getValue"),g=$("#cbNewSupplierShippingState").combobox("getValue"),h=$("#fldNewSupplierShippingAddress1").textbox("getValue"),V=$("#fldNewSupplierShippingAddress2").textbox("getValue"),A=$("#fldNewSupplierShippingAddress3").textbox("getValue"),C=$("#fldNewSupplierShippingAddress4").textbox("getValue"),y=$("#fldNewSupplierShippingCity").textbox("getValue"),v=$("#fldNewSupplierShippingPostcode").textbox("getValue"),k=$("#cbNewSupplierShippingCountry").combobox("getValue"),F=$("#cbNewSupplierShippingState").combobox("getValue"),B=$("#fldNewSupplierDaysCredit").numberbox("getValue"),E=$("#fldNewSupplierLineLimit").numberbox("getValue"),L=$("#fldNewSupplierOrderLimit").numberbox("getValue"),T=$("#fldNewSupplierCreditLimit").numberbox("getValue"),P=doGetComboTreeSelectedId("cbNewSupplierSalesAccount"),D=doGetComboTreeSelectedId("cbNewSupplierIncomeAccount"),I=doGetComboTreeSelectedId("cbNewSupplierExpenseAccount"),G=doGetComboTreeSelectedId("cbNewSupplierAssetAccount"),M=$("#fldNewSupplierAcn").textbox("getValue"),U=$("#fldNewSupplierAbn").textbox("getValue"),O=$("#fldNewSupplierHsCode").textbox("getValue"),H=$("#fldNewSupplierCustom1").textbox("getValue"),q=$("#fldNewSupplierCustom2").textbox("getValue");_.isBlank(t)?doMandatoryTextbox("Please enter an client name","fldNewClientName"):_.isBlank(l)?doMandatoryTextbox("Please enter a unique client code","fldNewClientCode"):Y?doServerDataMessage("newsupplier",{parentid:e,name:t,code:l,email1:o,url1:i,phone1:p,fax1:d,contact1:r,address1:b,address2:x,address3:S,address4:N,city:w,state:g,postcode:f,country:m,contact2:a,shiptoaddress1:h,shiptoaddress2:V,shiptoaddress3:A,shiptoaddress4:C,shiptocity:y,shiptostate:F,shiptopostcode:v,shiptocountry:k,bankname:u,bankbsb:c,bankaccountno:s,bankaccountname:n,dayscredit:B,linelimit:E,orderlimit:L,creditlimit:T,costofgoodsaccountid:P,incomeaccountid:D,expenseaccountid:I,assetaccountid:G,isactive:!0,issupplier:!1,isclient:!0,acn:M,abn:U,hscode:O,custcode1:H,custcode2:q},{type:"refresh"}):doServerDataMessage("savesupplier",{supplierid:R,parentid:e,name:t,code:l,email1:o,url1:i,phone1:p,fax1:d,contact1:r,address1:b,address2:x,address3:S,address4:N,city:w,state:g,postcode:f,country:m,contact2:a,shiptoaddress1:h,shiptoaddress2:V,shiptoaddress3:A,shiptoaddress4:C,shiptocity:y,shiptostate:F,shiptopostcode:v,shiptocountry:k,bankname:u,bankbsb:c,bankaccountno:s,bankaccountname:n,dayscredit:B,linelimit:E,orderlimit:L,creditlimit:T,costofgoodsaccountid:P,incomeaccountid:D,expenseaccountid:I,assetaccountid:G,isactive:!0,issupplier:!1,isclient:!0,acn:M,abn:U,hscode:O,custcode1:H,custcode2:q},{type:"refresh"})}},{text:"Reset",handler:function(){i()}},{text:"Close",handler:function(){$("#dlgSupplierNew").dialog("close")}}]}).dialog("center").dialog("open")}