function doDlgRepPOSSalesTotals(){function e(){$("#dtRepPOSSalesTotalsDateFrom").datebox("clear"),$("#dtRepPOSSalesTotalsDateTo").datebox("clear"),$("#divPOSSalesTotalsG").datagrid("loadData",[])}function t(e,t){var o=_.toBigNum(0);$("#divPOSSalesTotalsG").datagrid("loadData",t.data.rs),t.data.rs.forEach(function(e){o=o.plus(e.total)}),$("#divPOSSalesTotalsG").datagrid("reloadFooter",[{total:'<span class="totals_footer">'+_.niceformatnumber(o,2)+"</span>"}])}function o(){var e=$("#dtRepPOSSalesTotalsDateFrom").datebox("getValue"),t=$("#dtRepPOSSalesTotalsDateTo").datebox("getValue"),o=moment();if(_.isBlank(t)){if(moment(e).isAfter(o))return void doMandatoryTextbox("Start date can not be after today...","dtRepPOSSalesTotalsDateFrom");t=o.format("YYYY-MM-DD 23:23:59")}if(_.isBlank(e)){if(moment(t).isBefore(o))return void doMandatoryTextbox("End date can not be before today...","dtRepPOSSalesTotalsDateTo");e=o.format("YYYY-MM-DD 00:00:00")}doServerDataMessage("report",{report:"pos-salestotals",datefrom:e,dateto:t},{type:"refresh"})}$("#divEvents").on("report-pos-salestotals",t),$("#divEvents").on("ordercreated",o),$("#divEvents").on("ordersaved",o),$("#divEvents").on("orderexpired",o),$("#divEvents").on("orderduplicated",o),$("#divEvents").on("ordernewversion",o),$("#dlgRepPOSSalesTotals").dialog({onClose:function(){$("#divEvents").off("report-pos-salestotals",t),$("#divEvents").off("ordercreated",o),$("#divEvents").off("ordersaved",o),$("#divEvents").off("orderexpired",o),$("#divEvents").off("orderduplicated",o),$("#divEvents").off("ordernewversion",o),e()},onOpen:function(){$("#dtRepPOSSalesTotalsDateFrom").datebox(),$("#dtRepPOSSalesTotalsDateTo").datebox(),$("#divPOSSalesTotalsG").datagrid({fitColumns:!1,singleSelect:!0,rownumbers:!0,striped:!0,showFooter:!0,columns:[[{title:"Type",field:"paymenttype",width:250,align:"left",resizable:!0,formatter:function(e,t){return _.isUndefined(t.paymenttype)?e:mapPaymentTypeToName(e)}},{title:"Amount",field:"total",width:100,align:"right",resizable:!0,formatter:function(e,t){return _.isUndefined(t.paymenttype)?e:_.niceformatnumber(e,2)}}]]}),doTextboxFocus("dtRepPOSSalesTotalsDateFrom")},buttons:[{text:"Run",handler:function(){o()}},{text:"Reset",handler:function(){e()}},{text:"Close",handler:function(){$("#dlgRepPOSSalesTotals").dialog("close")}}]}).dialog("center").dialog("open")}