var chatsTabWidgetsLoaded=!1,grid_messages=[];function doChatTabWidgets(){chatsTabWidgetsLoaded||(chatsTabWidgetsLoaded=!0,$("#divChatG").datagrid({idField:"id",fitColumns:!1,singleSelect:!0,rownumbers:!1,striped:!0,loader:function(e,s,d){var t=[];grid_messages.forEach(function(e,s){t.push({id:s,message:e.message,date:moment(e.date).fromNow(),by:e.by,senderuuid:e.senderuuid})}),s({total:t.length,rows:t})},frozenColumns:[[{title:"By",field:"by",width:200,align:"left",resizable:!0,styler:function(e,s,d){return s.senderuuid==uuid?"color: "+colour_dodgerblue:"color: #000000"}}]],columns:[[{title:"Message",field:"message",width:400,align:"left",resizable:!0},{title:"Date",field:"date",width:150,align:"right",resizable:!0}]]}))}function doAddNewChatMsg(e){grid_messages.push({message:e.msg,date:e.date,by:e.by,senderuuid:e.senderuuid}),$("#divChatG").datagrid("reload")}function doSendMessage(){var e=$("#fldClientsMessage").textbox("getValue");primus.emit("chatmsg",{fguid:fguid,uuid:uuid,session:session,msg:e,pdata:{type:"dosendmessage"}}),$("#fldClientsMessage").textbox("clear")}