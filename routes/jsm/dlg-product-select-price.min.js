function doDlgProductSelectPrice(e,o,i,r,n){function t(e,i){var t=[];i.data.rs.forEach(function(e){(!(!_.isUndefined(r)&&!_.isNull(e.clientid))||r==e.clientid)&&t.push({id:doNiceId(e.id),clientid:e.clientid,price:e.unitprice,price1:e.unitprice1,price2:e.unitprice2,price3:e.unitprice3,price4:e.unitprice4,price5:e.unitprice5,minqty:e.minqty,maxqty:e.maxqty})}),$("#divProductSelectPriceG").datagrid("loadData",t)}$("#divEvents").on("getproductprices",t),$("#dlgProductSelectPrice").dialog({title:"Prices for "+i,onClose:function(){$("#divEvents").off("getproductprices",t)},onOpen:function(){$("#divProductSelectPriceG").datagrid({idField:"id",fitColumns:!1,singleSelect:!0,rownumbers:!0,striped:!0,columns:[[{title:"Price",rowspan:2,field:"price",width:100,align:"right",resizable:!0,styler:function(e,i,t){if(!_.isNull(i.clientid))return css_gridcol_client_price},formatter:function(e,i,t){return _.niceformatnumber(e)},align:"right"},{title:"Level",colspan:5},{title:"Min Qty",rowspan:2,field:"minqty",width:100,align:"right",resizable:!0,formatter:function(e,i,t){return _.niceformatqty(e)},align:"right"},{title:"Max Qty",rowspan:2,field:"maxqty",width:100,align:"right",resizable:!0,formatter:function(e,i,t){return _.niceformatqty(e)},align:"right"}],[{title:"1",field:"price1",width:100,align:"right",resizable:!0,editor:{type:"numberbox",options:{groupSeparator:",",precision:2}},formatter:function(e,i,t){return _.niceformatnumber(e)},align:"right"},{title:"2",field:"price2",width:100,align:"right",resizable:!0,editor:{type:"numberbox",options:{groupSeparator:",",precision:2}},formatter:function(e,i,t){return _.niceformatnumber(e)},align:"right"},{title:"3",field:"price3",width:100,align:"right",resizable:!0,editor:{type:"numberbox",options:{groupSeparator:",",precision:2}},formatter:function(e,i,t){return _.niceformatnumber(e)},align:"right"},{title:"4",field:"price4",width:100,align:"right",resizable:!0,editor:{type:"numberbox",options:{groupSeparator:",",precision:2}},formatter:function(e,i,t){return _.niceformatnumber(e)},align:"right"},{title:"5",field:"price5",width:100,align:"right",resizable:!0,editor:{type:"numberbox",options:{groupSeparator:",",precision:2}},formatter:function(e,i,t){return _.niceformatnumber(e)},align:"right"}]],onRowContextMenu:function(e,i,t){},onLoadSuccess:function(e){if(0<e.rows.length)if(1==e.rows.length)$("#divProductSelectPriceG").datagrid("selectRow",0);else for(var i=null,t=null,r=null,n=0;n<e.rows.length;n++)if(i=_.toBigNum(o),t=_.toBigNum(e.rows[n].minqty),r=_.toBigNum(e.rows[n].maxqty),t.isZero()&&r.isZero())$("#divProductSelectPriceG").datagrid("selectRow",n);else if(t.greaterThan(0)&&r.greaterThan(0)){if(i.greaterThanOrEqualTo(t)&&r.greaterThanOrEqualTo(i)){$("#divProductSelectPriceG").datagrid("selectRow",n);break}}else{if(r.greaterThanOrEqualTo(i)){$("#divProductSelectPriceG").datagrid("selectRow",n);break}if(i.greaterThanOrEqualTo(t)){$("#divProductSelectPriceG").datagrid("selectRow",n);break}}},onDblClickCell:function(e,i,t){if(!_.isUndefined(n)&&!_.isNull(n)){var r=$(this).datagrid("getSelected");n(r.price)}$("#dlgProductSelectPrice").dialog("close")}}),doServerDataMessage("getproductprices",{productid:e},{type:"refresh"})},buttons:[{text:"Select",handler:function(){doGridGetSelectedRowData("divProductSelectPriceG",function(e){_.isUndefined(n)||_.isNull(n)||n(e.price)}),$("#dlgProductSelectPrice").dialog("close")}},{text:"Close",handler:function(){$("#dlgProductSelectPrice").dialog("close")}}]}).dialog("center").dialog("open")}