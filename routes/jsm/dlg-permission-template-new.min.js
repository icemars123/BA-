var selectedPermissionTemplateId=null;function doDlgPermissionTemplateNew(e,B){var I=_.isUndefined(B)||_.isNull(B),a={};function r(e,s,i){return{name:e,value:s,group:i,editor:{type:"checkbox",options:{on:1,off:0}}}}function n(e,s,i){return{name:e,value:s,group:i,editor:{type:"textarea",id:"fldNewPermissionTemplateName"}}}function s(e,s){$("#dlgPermissionTemplates").dialog("close")}function i(e,s){a=s.data.permissiontemplate,t()}function t(){I?($("#divPermissionTemplatesPG1").propertygrid({showGroup:!0,scrollbarSize:0,loader:function(e,s,i){cache_permissionTemplateNames=[],cache_permissionTemplateNames.push(n("Name","","Template")),s({total:cache_permissionTemplateNames.length,rows:cache_permissionTemplateNames})},columns:[[{field:"name",title:"Name",width:70},{field:"value",title:"Value",width:100}]]}),$("#divPermissionTemplatesPG2").propertygrid({showGroup:!0,scrollbarSize:0,loader:function(e,s,i){cache_userpermissions=[],cache_userpermissions.push(r("Can View",0,"Orders")),cache_userpermissions.push(r("Can Create",0,"Orders")),cache_userpermissions.push(r("Can View",0,"Invoices")),cache_userpermissions.push(r("Can Create",0,"Invoices")),cache_userpermissions.push(r("Can View",0,"Inventory")),cache_userpermissions.push(r("Can Create",0,"Inventory")),cache_userpermissions.push(r("Can View",0,"Payroll")),cache_userpermissions.push(r("Can Create",0,"Payroll")),cache_userpermissions.push(r("Can View",0,"Products")),cache_userpermissions.push(r("Can Create",0,"Products")),cache_userpermissions.push(r("Can View",0,"Clients")),cache_userpermissions.push(r("Can Create",0,"Clients")),cache_userpermissions.push(r("Can View",0,"Codes")),cache_userpermissions.push(r("Can Create",0,"Codes")),cache_userpermissions.push(r("Can View",0,"Users")),cache_userpermissions.push(r("Can Create",0,"Users")),cache_userpermissions.push(r("Can View",0,"Builds")),cache_userpermissions.push(r("Can Create",0,"Builds")),cache_userpermissions.push(r("Can View",0,"Templates")),cache_userpermissions.push(r("Can Create",0,"Templates")),cache_userpermissions.push(r("Can View",0,"Banking")),cache_userpermissions.push(r("Can Create",0,"Banking")),cache_userpermissions.push(r("Can View",0,"Purchasing")),cache_userpermissions.push(r("Can Create",0,"Purchasing")),cache_userpermissions.push(r("Can View",0,"Alerts")),cache_userpermissions.push(r("Can Create",0,"Alerts")),cache_userpermissions.push(r("Can View",0,"Dashboard")),cache_userpermissions.push(r("Can Create",0,"Dashboard")),s({total:cache_userpermissions.length,rows:cache_userpermissions})},columns:[[{field:"name",title:"Action",width:70},{field:"value",title:"Permission",width:100,formatter:function(e,s,i){return mapBoolToImage(e)}}]]})):_.isEmpty(a)||(console.log(a.name),$("#divPermissionTemplatesPG1").propertygrid({showGroup:!0,scrollbarSize:0,loader:function(e,s,i){cache_permissionTemplateNames=[],cache_permissionTemplateNames.push(n("Name",a.name,"Template")),s({total:cache_permissionTemplateNames.length,rows:cache_permissionTemplateNames})},columns:[[{field:"name",title:"Name",width:70},{field:"value",title:"Value",width:100}]]}),$("#divPermissionTemplatesPG2").propertygrid({showGroup:!0,scrollbarSize:0,loader:function(e,s,i){cache_userpermissions=[],cache_userpermissions.push(r("Can View",a.canvieworders,"Orders")),cache_userpermissions.push(r("Can Create",a.cancreateorders,"Orders")),cache_userpermissions.push(r("Can View",a.canviewinvoices,"Invoices")),cache_userpermissions.push(r("Can Create",a.cancreateinvoices,"Invoices")),cache_userpermissions.push(r("Can View",a.canviewinventory,"Inventory")),cache_userpermissions.push(r("Can Create",a.cancreateinventory,"Inventory")),cache_userpermissions.push(r("Can View",a.canviewpayroll,"Payroll")),cache_userpermissions.push(r("Can Create",a.cancreatepayroll,"Payroll")),cache_userpermissions.push(r("Can View",a.canviewproducts,"Products")),cache_userpermissions.push(r("Can Create",a.cancreateproducts,"Products")),cache_userpermissions.push(r("Can View",a.canviewclients,"Clients")),cache_userpermissions.push(r("Can Create",a.cancreateclients,"Clients")),cache_userpermissions.push(r("Can View",a.canviewcodes,"Codes")),cache_userpermissions.push(r("Can Create",a.cancreatecodes,"Codes")),cache_userpermissions.push(r("Can View",a.canviewusers,"Users")),cache_userpermissions.push(r("Can Create",a.cancreateusers,"Users")),cache_userpermissions.push(r("Can View",a.canviewbuilds,"Builds")),cache_userpermissions.push(r("Can Create",a.cancreatebuilds,"Builds")),cache_userpermissions.push(r("Can View",a.canviewtemplates,"Templates")),cache_userpermissions.push(r("Can Create",a.cancreatetemplates,"Templates")),cache_userpermissions.push(r("Can View",a.canviewbanking,"Banking")),cache_userpermissions.push(r("Can Create",a.cancreatebanking,"Banking")),cache_userpermissions.push(r("Can View",a.canviewpurchasing,"Purchasing")),cache_userpermissions.push(r("Can Create",a.cancreatepurchasing,"Purchasing")),cache_userpermissions.push(r("Can View",a.canviewalerts,"Alerts")),cache_userpermissions.push(r("Can Create",a.cancreatealerts,"Alerts")),cache_userpermissions.push(r("Can View",a.canviewdashboard,"Dashboard")),cache_userpermissions.push(r("Can Create",a.cancreatedashboard,"Dashboard")),s({total:cache_userpermissions.length,rows:cache_userpermissions})},columns:[[{field:"name",title:"Action",width:70},{field:"value",title:"Permission",width:100,formatter:function(e,s,i){return mapBoolToImage(e)}}]]}))}console.log("gavin1"),$("#divEvents").on("newpermissiontemplate",s),$("#divEvents").on("savepermissiontemplate",s),$("#divEvents").on("loadpermissiontemplate",i),$("#dlgPermissionTemplates").dialog({title:"Create User Permission Template",onClose:function(){$("#divEvents").off("newpermissiontemplate",s),$("#divEvents").off("savepermissiontemplate",s),$("#divEvents").off("loadpermissiontemplate",i)},onOpen:function(){$("#divPermissionTemplatesPG1").propertygrid({showGroup:!0,scrollbarSize:0,loader:function(e,s,i){cache_permissionTemplateNames=[],cache_permissionTemplateNames.push(n("Name","","Template")),s({total:cache_permissionTemplateNames.length,rows:cache_permissionTemplateNames})},columns:[[{field:"name",title:"Name",width:70},{field:"value",title:"Value",width:100}]]}),$("#divPermissionTemplatesPG2").propertygrid({showGroup:!0,scrollbarSize:0,loader:function(e,s,i){cache_userpermissions=[],cache_userpermissions.push(r("Can View",0,"Orders")),cache_userpermissions.push(r("Can Create",0,"Orders")),cache_userpermissions.push(r("Can View",0,"Invoices")),cache_userpermissions.push(r("Can Create",0,"Invoices")),cache_userpermissions.push(r("Can View",0,"Inventory")),cache_userpermissions.push(r("Can Create",0,"Inventory")),cache_userpermissions.push(r("Can View",0,"Payroll")),cache_userpermissions.push(r("Can Create",0,"Payroll")),cache_userpermissions.push(r("Can View",0,"Products")),cache_userpermissions.push(r("Can Create",0,"Products")),cache_userpermissions.push(r("Can View",0,"Clients")),cache_userpermissions.push(r("Can Create",0,"Clients")),cache_userpermissions.push(r("Can View",0,"Codes")),cache_userpermissions.push(r("Can Create",0,"Codes")),cache_userpermissions.push(r("Can View",0,"Users")),cache_userpermissions.push(r("Can Create",0,"Users")),cache_userpermissions.push(r("Can View",0,"Builds")),cache_userpermissions.push(r("Can Create",0,"Builds")),cache_userpermissions.push(r("Can View",0,"Templates")),cache_userpermissions.push(r("Can Create",0,"Templates")),cache_userpermissions.push(r("Can View",0,"Banking")),cache_userpermissions.push(r("Can Create",0,"Banking")),cache_userpermissions.push(r("Can View",0,"Purchasing")),cache_userpermissions.push(r("Can Create",0,"Purchasing")),cache_userpermissions.push(r("Can View",0,"Alerts")),cache_userpermissions.push(r("Can Create",0,"Alerts")),cache_userpermissions.push(r("Can View",0,"Dashboard")),cache_userpermissions.push(r("Can Create",0,"Dashboard")),s({total:cache_userpermissions.length,rows:cache_userpermissions})},columns:[[{field:"name",title:"Action",width:70},{field:"value",title:"Permission",width:100,formatter:function(e,s,i){return mapBoolToImage(e)}}]]}),I?$("#btnPermissionTemplateNewAdd").linkbutton({text:"Add"}):$("#btnPermissionTemplateNewAdd").linkbutton({text:"Save"}),_.isUndefined(B)||_.isNull(B)?t():doServerDataMessage("loadpermissiontemplate",{permissiontemplateid:B},{type:"refresh"})},buttons:[{text:"Add",id:"btnPermissionTemplateNewAdd",handler:function(){var e=$("#divPermissionTemplatesPG1").propertygrid("getRows")[0].value,s=$("#divPermissionTemplatesPG2").propertygrid("getRows")[0].value,i=$("#divPermissionTemplatesPG2").propertygrid("getRows")[1].value,a=$("#divPermissionTemplatesPG2").propertygrid("getRows")[2].value,r=$("#divPermissionTemplatesPG2").propertygrid("getRows")[3].value,n=$("#divPermissionTemplatesPG2").propertygrid("getRows")[4].value,t=$("#divPermissionTemplatesPG2").propertygrid("getRows")[5].value,o=$("#divPermissionTemplatesPG2").propertygrid("getRows")[6].value,c=$("#divPermissionTemplatesPG2").propertygrid("getRows")[7].value,p=$("#divPermissionTemplatesPG2").propertygrid("getRows")[8].value,u=$("#divPermissionTemplatesPG2").propertygrid("getRows")[9].value,m=$("#divPermissionTemplatesPG2").propertygrid("getRows")[10].value,l=$("#divPermissionTemplatesPG2").propertygrid("getRows")[11].value,h=$("#divPermissionTemplatesPG2").propertygrid("getRows")[12].value,d=$("#divPermissionTemplatesPG2").propertygrid("getRows")[13].value,v=$("#divPermissionTemplatesPG2").propertygrid("getRows")[14].value,w=$("#divPermissionTemplatesPG2").propertygrid("getRows")[15].value,C=$("#divPermissionTemplatesPG2").propertygrid("getRows")[16].value,g=$("#divPermissionTemplatesPG2").propertygrid("getRows")[17].value,P=$("#divPermissionTemplatesPG2").propertygrid("getRows")[18].value,T=$("#divPermissionTemplatesPG2").propertygrid("getRows")[19].value,y=$("#divPermissionTemplatesPG2").propertygrid("getRows")[20].value,f=$("#divPermissionTemplatesPG2").propertygrid("getRows")[21].value,V=$("#divPermissionTemplatesPG2").propertygrid("getRows")[22].value,G=$("#divPermissionTemplatesPG2").propertygrid("getRows")[23].value,b=$("#divPermissionTemplatesPG2").propertygrid("getRows")[24].value,R=$("#divPermissionTemplatesPG2").propertygrid("getRows")[25].value,N=$("#divPermissionTemplatesPG2").propertygrid("getRows")[26].value,k=$("#divPermissionTemplatesPG2").propertygrid("getRows")[27].value;_.isBlank(e)?doMandatoryTextbox("Please enter a permission template name","fldNewPermissionTemplateName"):I?doServerDataMessage("newpermissiontemplate",{name:e,canvieworders:s,cancreateorders:i,canviewinvoices:a,cancreateinvoices:r,canviewinventory:n,cancreateinventory:t,canviewpayroll:o,cancreatepayroll:c,canviewproducts:p,cancreateproducts:u,canviewclients:m,cancreateclients:l,canviewcodes:h,cancreatecodes:d,canviewusers:v,cancreateusers:w,canviewbuilds:C,cancreatebuilds:g,canviewtemplates:P,cancreatetemplates:T,canviewbanking:y,cancreatebanking:f,canviewpurchasing:V,cancreatepurchasing:G,canviewalerts:b,cancreatealerts:R,canviewdashboard:N,cancreatedashboard:k},{type:"refresh"}):doServerDataMessage("savepermissiontemplate",{permissiontemplateid:B,name:e,canvieworders:s,cancreateorders:i,canviewinvoices:a,cancreateinvoices:r,canviewinventory:n,cancreateinventory:t,canviewpayroll:o,cancreatepayroll:c,canviewproducts:p,cancreateproducts:u,canviewclients:m,cancreateclients:l,canviewcodes:h,cancreatecodes:d,canviewusers:v,cancreateusers:w,canviewbuilds:C,cancreatebuilds:g,canviewtemplates:P,cancreatetemplates:T,canviewbanking:y,cancreatebanking:f,canviewpurchasing:V,cancreatepurchasing:G,canviewalerts:b,cancreatealerts:R,canviewdashboard:N,cancreatedashboard:k},{type:"refresh"})}},{text:"Reset",handler:function(){t()}},{text:"Close",handler:function(){$("#dlgPermissionTemplates").dialog("close")}}]}).dialog("center").dialog("open")}