exports.dropClientAttachmentPost=function(n,o){var s={message:"Error writing file"};__.isUndefined(n.body)||__.isNull(n.body)?o.json({message:"No form to upload"}):__.isUndefined(n.body.clientid)||__.isNull(n.body.clientid)?o.json({message:"No file to upload"}):__.isUndefined(n.files)||__.isUndefined(n.files.file)||global.modclients.newClientAttachment({filename:n.files.file.originalFilename,clientid:n.body.clientid,uuid:n.body.uuid,description:n.body.description,mimetype:n.files.file.type,size:n.files.file.size},function(i,e){if(i)o.json(s);else{var l=global.path.join(__dirname,global.config.folders.clientattachments+e+"_"+n.body.clientid+"_"+n.files.file.originalFilename);global.fs.rename(n.files.file.path,l,function(i){i?o.json(s):global.fs.unlink(n.files.file.path,function(){i||(s={id:e,filename:n.files.file.originalFilename}),o.json(s)})})}})};