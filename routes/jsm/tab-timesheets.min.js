var timesheetsTabWidgetsLoaded=!1,editingTimesheetIndex=null,tbTimesheets=[{text:"Clear",iconCls:"icon-clear",handler:doTimesheetsClear},{text:"Edit",iconCls:"icon-edit",handler:doTimesheetsEdit},{text:"Cancel",iconCls:"icon-cancel",handler:doTimesheetsCancel},{text:"Save",iconCls:"icon-save",handler:doTimesheetsSave},{text:"Details",iconCls:"icon-teacher",handler:doTimesheetsDetails}];function doTimesheetsClear(){$("#divTimesheetsG").datagrid("clearSelections")}function doTimesheetsEdit(){if(_.isNull(editingTimesheetIndex)){var e=$("#divTimesheetsG").datagrid("getSelected");if(e){editingTimesheetIndex=$("#divTimesheetsG").datagrid("getRowIndex",e),$("#divTimesheetsG").datagrid("beginEdit",editingTimesheetIndex);var i=$("#divTimesheetsG").datagrid("getEditor",{index:editingTimesheetIndex,field:"email"});$(i.target).focus()}}}function doTimesheetsCancel(){_.isNull(editingTimesheetIndex)||($("#divTimesheetsG").datagrid("cancelEdit",editingTimesheetIndex),editingTimesheetIndex=null)}function doTimesheetsSave(){if(!_.isNull(editingTimesheetIndex)){$("#divTimesheetsG").datagrid("endEdit",editingTimesheetIndex);var e=$("#divTimesheetsG").datagrid("getSelected");e&&primus.emit("savestatusalert",{fguid:fguid,uuid:uuid,session:session,statusalertid:e.id,useruuid:e.uuid,status:e.status,email:e.email,mobile:e.mobile,pdata:{type:"dostatusalertssave"}}),editingTimesheetIndex=null}}function doTimesheetsDetails(){}function doTimesheetsTabWidgets(){timesheetsTabWidgetsLoaded||($("#divEvents").on("listpayrollemployees",function(e,i){refreshFromCacheTimesheets(i.pdata)}),timesheetsTabWidgetsLoaded=!0,$("#divTimesheetsG").datagrid({idField:"id",fitColumns:!1,singleSelect:!0,rownumbers:!0,striped:!0,toolbar:tbTimesheets,loader:function(e,i,t){i({total:cache_timesheets.length,rows:cache_timesheets})},frozenColumns:[[{title:"Employee",rowspan:2,field:"name",width:300,align:"left",resizable:!0}],[]],columns:[[{title:"Hours",colspan:3},{title:"Tax",rowspan:2,field:"tax",width:150,align:"right",resizable:!0},{title:"Super",rowspan:2,field:"super",width:150,align:"right",resizable:!0},{title:"Net Pay",rowspan:2,field:"netpay",width:150,align:"right",resizable:!0},{title:"Type",rowspan:2,field:"type",width:150,align:"right",resizable:!0,formatter:function(e,i,t){return doGetStringFromIdInObjArray(employmenttypes,e)}},{title:"Modified",rowspan:2,field:"modified",width:150,align:"right",resizable:!0},{title:"By",rowspan:2,field:"by",width:200,align:"left",resizable:!0}],[{title:"Normal",field:"normal",width:200,align:"right",resizable:!0,editor:{type:"numberbox",options:{precision:2}}},{title:"Overtime",field:"special",width:200,align:"right",resizable:!0,editor:{type:"numberbox",options:{precision:2}}},{title:"Leave",field:"leave",width:200,align:"left",resizable:!0}]],onRowContextMenu:function(e,i,t){t&&(e.preventDefault(),$(this).datagrid("selectRow",i),$("#divTimesheetsMenuPopup").menu("show",{left:e.pageX,top:e.pageY}))},onDblClickCell:function(e,i,t){if(_.isNull(editingTimesheetIndex)){editingTimesheetIndex=e,$(this).datagrid("beginEdit",editingTimesheetIndex),-1!=["normal","special"].indexOf(i)&&(i="normal");var s=$(this).datagrid("getEditor",{index:e,field:i});$(s.target).focus()}}}))}function refreshFromCacheTimesheets(e){timesheetsTabWidgetsLoaded&&("refresh"==e.type&&$("#divTimesheetsG").datagrid("reload"),_.isUndefined(e.timesheetid)||_.isNull(e.timesheetid)||$("#divTimesheetsG").datagrid("selectRecord",e.timesheetid))}