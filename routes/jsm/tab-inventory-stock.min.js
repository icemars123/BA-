var invstockTabWidgetsLoaded=!1;function doInvStockTabSearch(e,t){doSearchCodeNameInGrid("divInventoryStockG",e,"code")}function doInvStockTabWidgets(){function e(){doServerMessage("liststock",{type:"refresh"})}invstockTabWidgetsLoaded||(invstockTabWidgetsLoaded=!0,$("#divEvents").on("liststock",function(e,t){var n=[];t.data.rs.forEach(function(e){n.push({locationname:doNiceString(e.locationname),id:doNiceId(e.id),code:doNiceString(e.code),name:doNiceString(e.name),qty:_.formatnumber(e.qty,4),orderqty:_.formatnumber(e.orderqty,4)})}),$("#divInventoryStockG").datagrid("loadData",n)}),$("#divEvents").on("addinventory",e),$("#divEvents").on("inventoryadded",e),$("#divEvents").on("buildinventory",e),$("#divEvents").on("inventorybuilt",e),$("#divEvents").on("orderdetailsaved",e),$("#divEvents").on("orderdetailexpired",e),$("#divEvents").on("expirebuild",e),$("#divEvents").on("buildexpired",e),$("#divEvents").on("transferinventory",e),$("#divEvents").on("stockspopup",function(e,t){"new"==t?doDlgInventoryNew():"clear"==t?$("#divInventoryStockG").datagrid("clearSelections"):"transfer"==t?doDlgInventoryTransfer():"builds"==t&&doBuilds()}),$("#divInventoryStockG").datagrid({idField:"id",groupField:"locationname",fitColumns:!1,singleSelect:!0,rownumbers:!0,striped:!0,toolbar:"#tbInvStock",view:groupview,frozenColumns:[[{title:"Code",field:"code",width:300,align:"left",resizable:!0}]],columns:[[{title:"Name",field:"name",width:300,align:"left",resizable:!0},{title:"Qty",field:"qty",width:100,align:"right",resizable:!0,styler:function(e,t,n){if(_.toBigNum(e).lessThan(0))return css_gridcol_qty_neg},formatter:function(e,t,n){return _.isUndefined(t.id)?e:_.niceformatqty(e)}},{title:"On Order",field:"orderqty",width:100,align:"right",resizable:!0,formatter:function(e,t,n){return _.isUndefined(t.id)?e:_.niceformatnumber(e)}}]],groupFormatter:function(e,t){return _.isNull(e)||_.isBlank(e)?'<span class="inventory_group_item">'+t.length+" Item(s)</span>":e+" - "+t.length+" Item(s)"}}),doServerMessage("liststock",{type:"refresh"}))}