function doDlgSupplierNotes(t){var d=null,n=null,s=null,o=null;function p(){doDlgNoteSearch(function(e){doServerDataMessage("searchsuppliernote",{supplierid:t.id,words:e},{type:"refresh"})},function(){doServerDataMessage("listsuppliernotes",{supplierid:t.id},{type:"refresh"})})}function e(e,i){t.id==i.data.supplierid&&doServerDataMessage("listsuppliernotes",{supplierid:t.id},{type:"refresh",supplieroteid:i.data.suppliernoteid})}function i(e,i){data=[],i.data.rs.forEach(function(e){data.push({id:doNiceId(e.id),notes:doNiceString(e.notes),date:doNiceDateModifiedOrCreated(e.datemodified,e.datecreated),by:doNiceModifiedBy(e.datemodified,e.usermodified,e.usercreated)})}),$("#divSupplierNotesG").datagrid("loadData",data),_.isUndefined(i.pdata.suppliernoteid)||_.isNull(i.pdata.suppliernoteid)||$("#divSupplierNotesG").datagrid("selectRecord",i.pdata.suppliernoteid)}function p(e,i){i.data.rs.forEach(function(e){$("#divSupplierNotesG").datagrid("selectRecord",e.id)})}function r(e,i){"new"==i?doServerDataMessage("newsuppliernote",{supplierid:t.id},{type:"refresh"}):"clear"==i?$("#divSupplierNotesG").datagrid("clearSelections"):"edit"==i?doGridGetSelectedRowData("divSupplierNotesG",function(e,i){_.isNull(d)&&(d=i,o="divSupplierNote-id-"+e.id,n=$("#"+o).html(),s=new nicEditor({fullPanel:!0,iconsPath:"/js/nicedit/nicEditorIcons.gif"}).panelInstance(o,{hasPanel:!0}))}):"cancel"==i?d=doGridCancelEdit("divSupplierNotesG",d,function(){s.removeInstance(o),$("#"+o).html(n),s=n=null}):"save"==i?doGridEndEditGetRow("divSupplierNotesG",d,function(e){var i=nicEditors.findEditor(o).getContent();doServerDataMessage("savesuppliernote",{suppliernoteid:e.id,notes:i},{type:"refresh"}),s.removeInstance(o),d=s=n=null}):"search"==i&&p()}$("#divEvents").on("newsuppliernote",e),$("#divEvents").on("savesuppliernote",e),$("#divEvents").on("suppliernotecreated",e),$("#divEvents").on("suppliernotesaved",e),$("#divEvents").on("listsuppliernotes",i),$("#divEvents").on("searchsuppliernote",p),$("#divEvents").on("suppliernotespopup",r),$("#dlgSupplierNotes").dialog({title:"Notes for "+t.name,onClose:function(){$("#divEvents").off("newsuppliernote",e),$("#divEvents").off("savesuppliernote",e),$("#divEvents").off("suppliernotecreated",e),$("#divEvents").off("suppliernotesaved",e),$("#divEvents").off("listsuppliernotes",i),$("#divEvents").off("searchsuppliernote",p),$("#divEvents").off("suppliernotespopup",r)},onOpen:function(){$("#divSupplierNotesG").datagrid({idField:"id",fitColumns:!0,singleSelect:!0,rownumbers:!1,toolbar:"#tbSupplierNotes",view:$.extend({},$.fn.datagrid.defaults.view,{renderRow:function(e,i,t,d,n){var s=[];return!t&&n.id?s.push('<td style="width: 950px;; padding: 5px 5px; border: 0;">  <div style="float: left; margin-left: 10px;">    <p><span class="c-label">Modified: </span>'+n.date+'</p>    <p><span class="c-label">By: </span>'+n.by+'</p>  </div>  <div style="clear: both;"></div>  <div id="divSupplierNote-id-'+n.id+'" style="float: left; margin-left: 10px; margin-right: 10px; width: 100%; height: 100px; border: 1px dashed #ddd">'+n.notes+"</div> </td>"):s.push('<td style="width: 100%; padding: 5px 5px; border: 0;"></td>'),s.join("")}}),onDblClickRow:function(e,i){_.isNull(d)&&i&&(d=e,o="divSupplierNote-id-"+i.id,n=$("#"+o).html(),s=new nicEditor({fullPanel:!0,iconsPath:"/js/nicedit/nicEditorIcons.gif"}).panelInstance(o,{hasPanel:!0}))}}),doServerDataMessage("listsuppliernotes",{supplierid:t.id},{type:"refresh",supplieroteid:args.data.suppliernoteid})},buttons:[{text:"Close",handler:function(){d=doGridCancelEdit("divSupplierNotesG",d),$("#dlgSupplierNotes").dialog("close")}}]}).dialog("center").dialog("open")}