exports.dropJobSheetPost=function(o,l){var s={message:"Error writing file"};__.isUndefined(o.body)||__.isNull(o.body)?l.json({message:"No form to upload"}):__.isUndefined(o.body.jobsheetid)||__.isNull(o.body.jobsheetid)?l.json({message:"No file to upload"}):__.isUndefined(o.files)||__.isUndefined(o.files.file)||global.modtpcc.updateJobSheetImage({filename:o.files.file.originalFilename,jobsheetid:o.body.jobsheetid,uuid:o.body.uuid,mimetype:o.files.file.type,size:o.files.file.size},function(e){if(e)l.json(s);else{var i=global.path.join(__dirname,global.doJobSheetImageURL(o.body.jobsheetid,o.files.file.originalFilename,o.files.file.type));global.fs.rename(o.files.file.path,i,function(e){e?l.json(s):global.fs.unlink(o.files.file.path,function(){e||(s={jobsheetid:o.body.jobsheetid,filename:o.files.file.originalFilename}),l.json(s)})})}})};